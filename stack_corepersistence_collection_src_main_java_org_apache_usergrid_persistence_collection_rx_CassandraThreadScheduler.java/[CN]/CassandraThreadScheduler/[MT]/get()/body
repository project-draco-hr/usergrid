{
  final ThreadFactory factory=new ThreadFactory(){
    private final AtomicLong counter=new AtomicLong();
    @Override public Thread newThread(    final Runnable r){
      final String threadName="RxCassandraIOThreadPool-" + counter.incrementAndGet();
      LOG.info("Allocating new IO thread with name {}",threadName);
      Thread t=new Thread(r,threadName);
      t.setDaemon(true);
      return t;
    }
  }
;
  final ThreadPoolExecutor pool=new ThreadPoolExecutor(0,maxThreadCount.get(),60L,TimeUnit.SECONDS,new SynchronousQueue<Runnable>(),factory,new ThreadPoolExecutor.AbortPolicy());
  maxThreadCount.addCallback(new Runnable(){
    @Override public void run(){
      pool.setMaximumPoolSize(maxThreadCount.get());
    }
  }
);
  return Schedulers.executor(pool);
}

{
  return Observable.just(edge).flatMap(new Func1<Edge,Observable<? extends MarkedEdge>>(){
    @Override public Observable<? extends MarkedEdge> call(    final Edge edge){
      final MutationBatch batch=keyspace.prepareMutationBatch();
      Observable<MarkedEdge> commitLog=seekAndDelete(scope,edge,commitLogSerialization,batch);
      Observable<MarkedEdge> storage=seekAndDelete(scope,edge,storageSerialization,batch);
      return Observable.merge(commitLog,storage).distinctUntilChanged().doOnCompleted(new Action0(){
        @Override public void call(){
          try {
            batch.execute();
          }
 catch (          ConnectionException e) {
            throw new RuntimeException("Could not delete marked edge",e);
          }
        }
      }
);
    }
  }
);
}

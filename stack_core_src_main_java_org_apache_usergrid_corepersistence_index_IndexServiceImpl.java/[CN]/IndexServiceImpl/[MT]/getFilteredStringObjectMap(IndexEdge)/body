{
  Id mapOwner=new SimpleId(indexEdge.getNodeId().getUuid(),TYPE_APPLICATION);
  final MapScope ms=CpNamingUtils.getEntityTypeMapScope(mapOwner);
  MapManager mm=mapManagerFactory.createMapManager(ms);
  Set<String> defaultProperties;
  ArrayList fieldsToKeep;
  String collectionName=CpNamingUtils.getCollectionNameFromEdgeName(indexEdge.getEdgeName());
  IndexSchemaCache indexSchemaCache=indexSchemaCacheFactory.getInstance(mm);
  Optional<String> collectionIndexingSchema=indexSchemaCache.getCollectionSchema(collectionName);
  String jsonSchemaMap=null;
  if (collectionIndexingSchema.isPresent()) {
    jsonSchemaMap=collectionIndexingSchema.get();
  }
  if (jsonSchemaMap != null) {
    Map jsonMapData=(Map)JsonUtils.parse(jsonSchemaMap);
    Schema schema=Schema.getDefaultSchema();
    defaultProperties=schema.getRequiredProperties(collectionName);
    fieldsToKeep=(ArrayList)jsonMapData.get("fields");
    defaultProperties.addAll(fieldsToKeep);
  }
 else {
    return Optional.empty();
  }
  return Optional.of(defaultProperties);
}

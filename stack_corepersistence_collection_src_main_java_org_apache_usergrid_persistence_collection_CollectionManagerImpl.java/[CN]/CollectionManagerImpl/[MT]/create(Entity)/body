{
  final UUID entityId=UUIDGenerator.newTimeUUID();
  final UUID version=entityId;
  final long created=timeService.getTime();
  try {
    BeanUtils.setProperty(entity,"uuid",entityId);
  }
 catch (  Throwable t) {
    logger.error("Unable to set uuid.  See nested exception",t);
    throw new RuntimeException("Unable to set uuid.  See nested exception",t);
  }
  entity.setVersion(version);
  entity.setCreated(created);
  entity.setUpdated(created);
  MvccEntityImpl mvccEntity=new MvccEntityImpl(context,entityId,version,entity);
  MutationBatch mutation=startStage.performStage(mvccEntity);
  writeStage.performStage(mvccEntity);
  commitStage.performStage(mvccEntity);
}

{
  List<QueueMessage> returnQueue=new ArrayList<>();
  try {
    QueueMessage message=null;
    int count=10;
    do {
      message=queue.poll(100,TimeUnit.MILLISECONDS);
      if (message != null) {
        returnQueue.add(message);
      }
    }
 while (queue.size() > 0 && count-- > 0);
  }
 catch (  InterruptedException ie) {
    throw new RuntimeException(ie);
  }
  return Observable.from(returnQueue);
}

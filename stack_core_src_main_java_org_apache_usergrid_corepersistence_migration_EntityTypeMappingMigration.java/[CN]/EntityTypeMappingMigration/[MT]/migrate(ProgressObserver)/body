{
  final AtomicLong atomicLong=new AtomicLong();
  AllEntitiesInSystemObservable.getAllEntitiesInSystem(managerCache).doOnNext(new Action1<AllEntitiesInSystemObservable.EntityData>(){
    @Override public void call(    final AllEntitiesInSystemObservable.EntityData entityData){
      final MapScope ms=new MapScopeImpl(entityData.entityId,CpNamingUtils.TYPES_BY_UUID_MAP);
      final MapManager mapManager=managerCache.getMapManager(ms);
      final UUID entityUuid=entityData.entityId.getUuid();
      final String entityType=entityData.entityId.getType();
      mapManager.putString(entityUuid.toString(),entityType);
      if (atomicLong.incrementAndGet() % 100 == 0) {
        updateStatus(atomicLong,observer);
      }
    }
  }
).toBlocking().lastOrDefault(null);
}

{
  final Id entityId=candidateResult.getId();
  final MvccEntity version=ids.getEntity(entityId);
  if (version == null) {
    logger.warn("Version for Entity {}:{} not found",entityId.getUuid(),entityId.getUuid());
    return false;
  }
  final UUID savedVersion=version.getVersion();
  if (UUIDComparator.staticCompare(savedVersion,candidateResult.getVersion()) > 0) {
    logger.debug("Stale version of Entity uuid:{} type:{}, stale v:{}, latest v:{}",new Object[]{entityId.getUuid(),entityId.getType(),savedVersion,candidateResult.getVersion()});
    return false;
  }
  final Optional<org.apache.usergrid.persistence.model.entity.Entity> entity=version.getEntity();
  if (!entity.isPresent()) {
    return false;
  }
  entityMapping.put(entityId,entity.get());
  return true;
}

{
  org.apache.usergrid.persistence.index.query.Query cpQuery=new org.apache.usergrid.persistence.index.query.Query();
  cpQuery.setCollection(query.getCollection());
  cpQuery.setConnectionType(query.getConnectionType());
  cpQuery.setCursor(query.getCursor());
  cpQuery.setEntityType(query.getEntityType());
  cpQuery.setFinishTime(query.getFinishTime());
  cpQuery.setLimit(query.getLimit());
  cpQuery.setPad(query.isPad());
  cpQuery.setPermissions(query.getPermissions());
  cpQuery.setQl(query.getQl());
  cpQuery.setReversed(query.isReversed());
  cpQuery.setStartTime(query.getStartTime());
  if (cpQuery.getRootOperand() == null) {
    if (query.containsSingleNameOrEmailIdentifier()) {
      Identifier ident=query.getSingleIdentifier();
      if (query.getEntityType().equals(User.ENTITY_TYPE) && ident.isEmail()) {
        org.apache.usergrid.persistence.index.query.Query newQuery=org.apache.usergrid.persistence.index.query.Query.fromQL("select * where email='" + query.getSingleNameOrEmailIdentifier() + "'");
        cpQuery.setRootOperand(newQuery.getRootOperand());
      }
 else {
        org.apache.usergrid.persistence.index.query.Query newQuery=org.apache.usergrid.persistence.index.query.Query.fromQL("select * where email='" + query.getSingleNameOrEmailIdentifier() + "'");
        cpQuery.setRootOperand(newQuery.getRootOperand());
      }
    }
 else     if (query.containsSingleUuidIdentifier()) {
      org.apache.usergrid.persistence.index.query.Query newQuery=org.apache.usergrid.persistence.index.query.Query.fromQL("select * where uuid='" + query.getSingleUuidIdentifier() + "'");
      cpQuery.setRootOperand(newQuery.getRootOperand());
    }
  }
  return cpQuery;
}

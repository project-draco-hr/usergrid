{
  if (query == null) {
    query=new Query();
  }
  headEntity=em.validate(headEntity);
  CollectionInfo collection=getDefaultSchema().getCollection(headEntity.getType(),collName);
  IndexScope indexScope=new IndexScopeImpl(applicationScope.getApplication(),cpHeadEntity.getId(),collName + COLLECTION_SUFFIX);
  EntityIndex ei=managerCache.getEntityIndex(indexScope);
  logger.debug("Searching collection {}",collName);
  logger.debug("Searching head entity scope {}:{}:{}",new String[]{headEntityScope.getApplication().toString(),headEntityScope.getOwner().toString(),collName});
  query.setEntityType(collection.getType());
  query=adjustQuery(query);
  CandidateResults crs=ei.search(query);
  return buildResults(query,crs,collName);
}

{
  if (query == null) {
    query=new Query();
    query.setCollection(collectionName);
  }
  headEntity=em.validate(headEntity);
  CollectionInfo collection=getDefaultSchema().getCollection(headEntity.getType(),collectionName);
  if (collection == null) {
    throw new RuntimeException("Cannot find collection-info for '" + collectionName + "' of "+ headEntity.getType()+ ":"+ headEntity.getUuid());
  }
  query.setEntityType(collection.getType());
  query=adjustQuery(query);
  final ReadPipelineBuilder readPipelineBuilder=pipelineBuilderFactory.createReadPipelineBuilder(applicationScope);
  readPipelineBuilder.withCursor(query.getCursor());
  readPipelineBuilder.withLimit(Optional.of(query.getLimit()));
  readPipelineBuilder.setStartId(cpHeadEntity.getId());
  if (query.isGraphSearch()) {
    readPipelineBuilder.getCollection(collectionName);
  }
 else {
    final String entityType=collection.getType();
    readPipelineBuilder.getCollectionWithQuery(collectionName,entityType,query.getQl().get());
  }
  final Observable<ResultsPage> resultsObservable=readPipelineBuilder.execute();
  return new ObservableQueryExecutor(resultsObservable).next();
}

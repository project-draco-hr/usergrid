{
  Assert.notNull(em,"Entity manager cannot be null");
  Assert.notNull(applicationId,"Application Id cannot be null");
  Assert.notNull(headEntity,"Head entity cannot be null");
  Assert.notNull(headEntity.getUuid(),"Head entity uuid cannot be null");
  this.em=em;
  this.emf=emf;
  this.applicationId=applicationId;
  this.headEntity=headEntity;
  organizationScope=emf.getOrganizationScope(applicationId);
  applicationScope=emf.getApplicationScope(applicationId);
  headEntityScope=new CollectionScopeImpl(applicationScope.getOrganization(),applicationScope.getOwner(),Schema.defaultCollectionName(headEntity.getType()));
  EntityCollectionManager ecm=ecmf.createCollectionManager(headEntityScope);
  cpHeadEntity=ecm.load(new SimpleId(headEntity.getUuid(),headEntity.getType())).toBlockingObservable().last();
  return this;
}

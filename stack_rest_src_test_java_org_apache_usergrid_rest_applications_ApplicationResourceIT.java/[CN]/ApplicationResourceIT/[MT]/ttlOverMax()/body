{
  String orgName=clientSetup.getOrganizationName().toLowerCase();
  String appName=clientSetup.getAppName().toLowerCase();
  String username="username";
  String name="name";
  User user=new User(username,name,username + "@usergrid.org","password");
  Entity entity=this.app().collection("users").post(user);
  assertNotNull(entity);
  refreshIndex();
  entity.chainPut("grant_type","password").chainPut("ttl",Long.MAX_VALUE);
  try {
    resource().path(String.format("/%s/%s/token",orgName,appName)).accept(MediaType.APPLICATION_JSON).type(MediaType.APPLICATION_JSON_TYPE).post(ApiResponse.class,entity);
    fail("This should cause an exception");
  }
 catch (  UniformInterfaceException uie) {
    assertEquals(String.valueOf(Status.BAD_REQUEST.getStatusCode()),String.valueOf(uie.getResponse().getStatus()));
  }
}

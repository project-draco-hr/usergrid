{
  final EdgeManager em=emf.createEdgeManager(scope);
  Id sourceId1=new SimpleId("source");
  Id sourceId2=new SimpleId("source2");
  Id targetId1=new SimpleId("target");
  Edge testTargetEdge=new SimpleEdge(sourceId1,"test",targetId1,UUIDGenerator.newTimeUUID());
  em.writeEdge(testTargetEdge);
  Edge testTarget2Edge=new SimpleEdge(sourceId2,"test",targetId1,UUIDGenerator.newTimeUUID());
  em.writeEdge(testTarget2Edge);
  Edge test2TargetEdge=new SimpleEdge(sourceId1,"test2",targetId1,UUIDGenerator.newTimeUUID());
  em.writeEdge(test2TargetEdge);
  final SearchEdgeTypes edgeTypes=new SimpleSearchEdgeTypes(testTargetEdge.getTargetNode(),null);
  Observable<String> edges=em.getSourceEdgeTypes(edgeTypes);
  List<String> results=edges.toList().toBlockingObservable().single();
  assertEquals("Size correct",2,results.size());
  assertTrue("Edges correct",results.contains("test"));
  assertTrue("Edges correct",results.contains("test2"));
  edges=em.getSourceEdgeTypes(new SimpleSearchEdgeIdTypes(testTargetEdge.getTargetNode(),"test",null));
  results=edges.toList().toBlockingObservable().single();
  assertEquals("Size correct",2,results.size());
  assertTrue("Types correct",results.contains(sourceId1.getType()));
  assertTrue("Types correct",results.contains(sourceId2.getType()));
  edges=em.getSourceEdgeIdTypes(new SimpleSearchEdgeIdTypes(testTargetEdge.getTargetNode(),"test2",null));
  results=edges.toList().toBlockingObservable().single();
  assertEquals("Size correct",1,results.size());
  assertTrue("Types correct",results.contains(sourceId1.getType()));
  em.deleteEdge(testTargetEdge);
  em.deleteEdge(testTarget2Edge);
  em.deleteEdge(test2TargetEdge);
  edges=em.getTargetEdgeTypes(new SimpleSearchEdgeTypes(testTargetEdge.getSourceNode(),null));
  results=edges.toList().toBlockingObservable().single();
  assertEquals("No results",0,results.size());
}

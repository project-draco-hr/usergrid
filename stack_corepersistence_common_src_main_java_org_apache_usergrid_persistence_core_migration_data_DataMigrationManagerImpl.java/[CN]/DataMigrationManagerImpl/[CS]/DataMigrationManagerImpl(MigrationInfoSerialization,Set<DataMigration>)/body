{
  Preconditions.checkNotNull(migrationInfoSerialization,"migrationInfoSerialization must not be null");
  Preconditions.checkNotNull(migrations,"migrations must not be null");
  this.migrationInfoSerialization=migrationInfoSerialization;
  for (  DataMigration migration : migrations) {
    Preconditions.checkNotNull(migration,"A migration instance in the set of migrations was null.  This is not allowed");
    final int version=migration.getVersion();
    final DataMigration existing=migrationTreeMap.get(version);
    if (existing != null) {
      final Class<? extends DataMigration> existingClass=existing.getClass();
      final Class<? extends DataMigration> currentClass=migration.getClass();
      throw new DataMigrationException(String.format("Data migrations must be unique.  Both classes %s and %s have version %d",existingClass,currentClass,version));
    }
    migrationTreeMap.put(version,migration);
  }
}

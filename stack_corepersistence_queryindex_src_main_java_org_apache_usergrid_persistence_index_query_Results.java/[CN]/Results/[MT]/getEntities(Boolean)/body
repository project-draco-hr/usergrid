{
  if (entities == null) {
    entities=new ArrayList<Entity>();
    EntityCollectionManager ecm=null;
    CollectionScope lastScope=null;
    for (    CandidateResult candidate : candidates) {
      if (!candidate.getCollectionScope().equals(lastScope)) {
        ecm=ecmf.createCollectionManager(candidate.getCollectionScope());
        lastScope=candidate.getCollectionScope();
      }
      Entity entity=ecm.load(candidate.getEntityId()).toBlockingObservable().last();
      if (!takeAllVersions && candidate.getEntityVersion().compareTo(entity.getVersion()) == -1) {
        log.debug("   Stale hit {} version {}",entity.getId(),entity.getVersion());
        continue;
      }
      entities.add(entity);
    }
  }
  return Collections.unmodifiableList(entities);
}

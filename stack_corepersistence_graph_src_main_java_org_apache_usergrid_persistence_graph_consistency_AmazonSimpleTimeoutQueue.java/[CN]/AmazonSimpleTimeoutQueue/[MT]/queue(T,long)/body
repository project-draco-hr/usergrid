{
  AWSCredentials awsCredentials=new BasicAWSCredentials(System.getProperty("accessKey"),System.getProperty("secretKey"));
  AmazonSQSAsyncClient sqsAsyncClient=new AmazonSQSAsyncClient(awsCredentials);
  SimpleAsynchronousMessage<T> asynchronousMessage=new SimpleAsynchronousMessage<T>(event,timeout);
  SendMessageResult sendMessageResult=null;
  if (!(event instanceof Serializable)) {
    throw new RuntimeException(event.getClass().getName() + " is not serializable!");
  }
  SendMessageRequest sendMessageRequest=null;
  try {
    sendMessageRequest=new SendMessageRequest(getQueueEndpoint(),mapper.writeValueAsString(asynchronousMessage));
    sendMessageRequest.setDelaySeconds((int)timeout);
    sqsAsyncClient.sendMessage(sendMessageRequest);
  }
 catch (  JsonProcessingException e) {
    logger.error("Couldn't serialize the following event: " + event.toString());
    throw new RuntimeException(e.getMessage());
  }
  ;
  logger.debug("Finished adding " + asynchronousMessage.toString() + " to the following queue: "+ queueEndpoint);
  return asynchronousMessage;
}

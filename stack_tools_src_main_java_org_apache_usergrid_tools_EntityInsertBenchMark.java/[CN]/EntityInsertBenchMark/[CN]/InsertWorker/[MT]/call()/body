{
  Keyspace ko=EntityInsertBenchMark.this.cass.getApplicationKeyspace(appId);
  EntityManagerImpl em=(EntityManagerImpl)emf.getEntityManager(appId);
  IndexBucketLocator indexBucketLocator=em.getIndexBucketLocator();
  for (int i=0; i < count; i++) {
    Mutator<ByteBuffer> m=createMutator(ko,be);
    DynamicEntity dynEntity=new DynamicEntity();
    dynEntity.setType("test");
    dynEntity.setUuid(UUIDUtils.newTimeUUID());
    String value=new StringBuilder().append(workerNumber).append("-").append(i).toString();
    String bucketId=indexBucketLocator.getBucket(dynEntity.getUuid());
    Object index_name=key(appId,"tests","test",bucketId);
    IndexEntry entry=new IndexEntry(dynEntity.getUuid(),"test",value,UUIDUtils.newTimeUUID());
    addInsertToMutator(m,ENTITY_INDEX,index_name,entry.getIndexComposite(),null,System.currentTimeMillis());
    UniqueIndexer indexer=new UniqueIndexer(m);
    indexer.writeIndex(appId,"tests",dynEntity.getUuid(),"test",value);
    m.execute();
    if (i % 100 == 0) {
      System.out.println(String.format("%s : Written %d of %d",Thread.currentThread().getName(),i,count));
    }
  }
  return null;
}

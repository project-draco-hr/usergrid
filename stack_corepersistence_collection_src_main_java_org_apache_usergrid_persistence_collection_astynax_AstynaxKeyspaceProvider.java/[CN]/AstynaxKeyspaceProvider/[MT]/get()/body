{
  AstyanaxConfiguration config=new AstyanaxConfigurationImpl().setDiscoveryType(NodeDiscoveryType.TOKEN_AWARE).setTargetCassandraVersion(cassandraVersion.get());
  ConnectionPoolConfiguration connectionPoolConfiguration=new ConnectionPoolConfigurationImpl("UsergridConnectionPool").setPort(cassandraPort.get()).setMaxConnsPerHost(cassandraConnections.get()).setSeeds(cassandraHosts.get()).setSocketTimeout(cassandraTimeout.get());
  AstyanaxContext<Keyspace> context=new AstyanaxContext.Builder().forCluster(clusterName.get()).forKeyspace(keyspaceName.get()).withAstyanaxConfiguration(config).withConnectionPoolConfiguration(connectionPoolConfiguration).withConnectionPoolMonitor(new Slf4jConnectionPoolMonitorImpl()).buildKeyspace(ThriftFamilyFactory.getInstance());
  context.start();
  return context.getClient();
}

{
  UUID queueId=getQueueId(queuePath);
  UUID consumerId=getConsumerId(queueId,query);
  QueueBounds bounds=getQueueBounds(queueId);
  List<UUID> ids=getIds(queueId,consumerId,bounds,getParams(queueId,consumerId,query));
  List<Message> messages=loadMessages(ids);
  QueueResults results=createResults(messages,queuePath,queueId,consumerId);
  writeClientPointer(queueId,consumerId,results.getLast());
  return results;
}

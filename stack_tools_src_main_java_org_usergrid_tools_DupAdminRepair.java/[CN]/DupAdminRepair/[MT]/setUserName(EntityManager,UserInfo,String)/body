{
  logger.info("Setting username to {} for user with username {} and id {}",new Object[]{newUserName,other.getUsername(),other.getUuid()});
  try {
    em.setProperty(new SimpleEntityRef("user",other.getUuid()),"username",newUserName,true);
  }
 catch (  DuplicateUniquePropertyExistsException e) {
    logger.warn("More than 1 user has the username of {}.  Setting the username to their username+UUID as a fallback",newUserName);
    setUserName(em,other,String.format("%s-%s",other.getUsername(),other.getUuid()));
  }
}

{
  Preconditions.checkNotNull(message,"Queue Message cannot be null for handleEntityDelete");
  final AsyncEvent event=(AsyncEvent)message.getBody();
  Preconditions.checkNotNull(message,"QueueMessage Body cannot be null for handleEntityDelete");
  Preconditions.checkArgument(event.getEventType() == AsyncEvent.EventType.ENTITY_DELETE,String.format("Event Type for handleEntityDelete must be ENTITY_DELETE, got %s",event.getEventType()));
  final ApplicationScope applicationScope=event.getApplicationScope();
  final Id entityId=event.getEntityId();
  if (logger.isDebugEnabled())   logger.debug("Deleting entity id from index in app scope {} with entityId {}",applicationScope,entityId);
  ack(message);
  final EventBuilderImpl.EntityDeleteResults entityDeleteResults=eventBuilder.buildEntityDelete(applicationScope,entityId);
  final Observable merged=Observable.merge(entityDeleteResults.getEntitiesCompacted(),entityDeleteResults.getIndexObservable());
  subscibeAndAck(merged,message);
}

{
  if (message instanceof Request) {
    Request req=(Request)message;
    count++;
    if (count % 10 == 0) {
      logger.info("UniqueValueActor {} processed {} requests",name,count);
    }
  }
  if (message instanceof Reservation) {
    Reservation res=(Reservation)message;
    try {
      Id owner=table.lookupOwner(res.getApplicationScope(),res.getOwner().getType(),res.getField());
      if (owner != null && owner.equals(res.getOwner())) {
        getSender().tell(new Response(Response.Status.IS_UNIQUE),getSender());
        return;
      }
 else       if (owner != null && !owner.equals(res.getOwner())) {
        getSender().tell(new Response(Response.Status.NOT_UNIQUE),getSender());
        return;
      }
      table.reserve(res.getApplicationScope(),res.getOwner(),res.getOwnerVersion(),res.getField());
      getSender().tell(new Response(Response.Status.IS_UNIQUE),getSender());
      actorSystemManager.publishToAllRegions("content",new Reservation(res),getSelf());
    }
 catch (    Throwable t) {
      getSender().tell(new Response(Response.Status.ERROR),getSender());
      logger.error("Error processing request",t);
    }
 finally {
    }
  }
 else   if (message instanceof Confirmation) {
    Confirmation con=(Confirmation)message;
    try {
      Id owner=table.lookupOwner(con.getApplicationScope(),con.getOwner().getType(),con.getField());
      if (owner != null && !owner.equals(con.getOwner())) {
        getSender().tell(new Response(Response.Status.NOT_UNIQUE),getSender());
        return;
      }
 else       if (owner == null) {
        getSender().tell(new Response(Response.Status.BAD_REQUEST),getSender());
        return;
      }
      table.confirm(con.getApplicationScope(),con.getOwner(),con.getOwnerVersion(),con.getField());
      getSender().tell(new Response(Response.Status.IS_UNIQUE),getSender());
      actorSystemManager.publishToAllRegions("content",new Reservation(con),getSelf());
    }
 catch (    Throwable t) {
      getSender().tell(new Response(Response.Status.ERROR),getSender());
      logger.error("Error processing request",t);
    }
 finally {
    }
  }
 else   if (message instanceof Cancellation) {
    Cancellation can=(Cancellation)message;
    try {
      Id owner=table.lookupOwner(can.getApplicationScope(),can.getOwner().getType(),can.getField());
      if (owner != null && !owner.equals(can.getOwner())) {
        getSender().tell(new Response(Response.Status.NOT_UNIQUE),getSender());
        return;
      }
 else       if (owner == null) {
        getSender().tell(new Response(Response.Status.BAD_REQUEST),getSender());
        return;
      }
      table.confirm(can.getApplicationScope(),can.getOwner(),can.getOwnerVersion(),can.getField());
      getSender().tell(new Response(Response.Status.SUCCESS),getSender());
      actorSystemManager.publishToAllRegions("content",new Reservation(can),getSelf());
    }
 catch (    Throwable t) {
      getSender().tell(new Response(Response.Status.ERROR),getSender());
      logger.error("Error processing request",t);
    }
  }
 else {
    unhandled(message);
  }
}

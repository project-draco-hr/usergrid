{
  if (!isTooSmallToCompact() && shouldCompact(currentTime)) {
    return Collections.singleton(getCompactionTarget());
  }
  return shards;
}

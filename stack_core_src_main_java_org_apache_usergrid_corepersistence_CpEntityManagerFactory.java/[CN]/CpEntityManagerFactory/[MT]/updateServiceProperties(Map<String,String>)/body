{
  EntityCollectionManager em=getManagerCache().getEntityCollectionManager(SYSTEM_PROPS_SCOPE);
  EntityIndex ei=getManagerCache().getEntityIndex(SYSTEM_PROPS_INDEX_SCOPE);
  Query q=Query.fromQL("select *");
  CandidateResults results=ei.search(q);
  Entity propsEntity;
  if (!results.isEmpty()) {
    propsEntity=em.load(results.iterator().next().getId()).toBlockingObservable().last();
  }
 else {
    propsEntity=new Entity(new SimpleId("properties"));
  }
  for (  String key : properties.keySet()) {
    propsEntity.setField(new StringField(key,properties.get(key)));
  }
  propsEntity=em.write(propsEntity).toBlockingObservable().last();
  ei.index(propsEntity);
  return true;
}

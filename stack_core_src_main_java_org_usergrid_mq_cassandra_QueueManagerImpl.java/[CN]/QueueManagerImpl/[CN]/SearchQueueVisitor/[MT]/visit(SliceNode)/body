{
  Collection<QuerySlice> slices=node.getAllSlices();
  int search_count=query.getLimit() + 1;
  if (slices.size() > 1) {
    search_count=DEFAULT_SEARCH_COUNT;
  }
  QueueSet results=null;
  for (  QuerySlice slice : slices) {
    queryProcessor.applyCursorAndSort(slice);
    QueueSet r=null;
    try {
      r=searchQueueIndex(publisherQueueId,slice,search_count);
    }
 catch (    Exception e) {
      logger.error("Error during search",e);
    }
    if (r.getCursor() != null) {
    }
    if (results != null) {
      results.and(r);
    }
 else {
      results=r;
    }
  }
  this.results.push(results);
}

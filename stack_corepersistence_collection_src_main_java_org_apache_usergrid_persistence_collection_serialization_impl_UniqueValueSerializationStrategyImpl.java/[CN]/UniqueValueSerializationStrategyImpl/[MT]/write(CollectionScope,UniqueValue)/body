{
  Preconditions.checkNotNull(value,"value is required");
  final Id entityId=value.getEntityId();
  final UUID entityVersion=value.getEntityVersion();
  final Field<?> field=value.getField();
  ValidationUtils.verifyIdentity(entityId);
  ValidationUtils.verifyVersion(entityVersion);
  log.debug("Writing unique value collectionScope={} id={} version={} name={} value={} ttl={} ",new Object[]{collectionScope.getName(),entityId,entityVersion,value.getField().getName(),value.getField().getValue()});
  final EntityVersion ev=new EntityVersion(entityId,entityVersion);
  final UniqueFieldEntry uniqueFieldEntry=new UniqueFieldEntry(entityVersion,field);
  return doWrite(collectionScope,value,new UniqueValueSerializationStrategyImpl.RowOp(){
    @Override public void doLookup(    final ColumnListMutation<EntityVersion> colMutation){
      colMutation.putColumn(ev,COL_VALUE);
    }
    @Override public void doLog(    final ColumnListMutation<UniqueFieldEntry> colMutation){
      colMutation.putColumn(uniqueFieldEntry,COL_VALUE);
    }
  }
);
}

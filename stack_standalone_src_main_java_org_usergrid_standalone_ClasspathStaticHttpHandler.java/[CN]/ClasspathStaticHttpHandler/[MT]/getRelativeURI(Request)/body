{
  String uri=request.getRequestURI();
  if (uri.indexOf("..") >= 0) {
    return null;
  }
  final String resourcesContextPath=request.getContextPath();
  if (resourcesContextPath.length() > 0) {
    if (!uri.startsWith(resourcesContextPath)) {
      return null;
    }
    uri=uri.substring(resourcesContextPath.length());
  }
  return uri;
}

{
  if ((clientId == null) || (clientSecret == null)) {
    return null;
  }
  UUID uuid=getUUIDFromClientId(clientId);
  if (uuid == null) {
    return null;
  }
  AuthPrincipalType type=getTypeFromClientId(clientId);
  if (type == null) {
    return null;
  }
  AccessInfo access_info=null;
  if (clientSecret.equals(getSecret(MANAGEMENT_APPLICATION_ID,type,uuid))) {
    if (type.equals(AuthPrincipalType.APPLICATION)) {
      ApplicationInfo app=getApplicationInfo(uuid);
      access_info=new AccessInfo().withExpiresIn(3600).withAccessToken(getTokenForPrincipal(ACCESS,null,MANAGEMENT_APPLICATION_ID,type,uuid,ttl)).withProperty("application",app.getId());
    }
 else     if (type.equals(AuthPrincipalType.ORGANIZATION)) {
      OrganizationInfo organization=getOrganizationByUuid(uuid);
      access_info=new AccessInfo().withExpiresIn(3600).withAccessToken(getTokenForPrincipal(ACCESS,null,MANAGEMENT_APPLICATION_ID,type,uuid,ttl)).withProperty("organization",getOrganizationData(organization)).withPasswordChanged(getLastAdminPasswordChange(uuid));
    }
  }
  return access_info;
}

{
  TokenInfo tokenInfo=tokens.getTokenInfo(token);
  if (tokenInfo == null) {
    return null;
  }
  if ((expected_token_type != null) && !expected_token_type.equals(tokenInfo.getType())) {
    return null;
  }
  AuthPrincipalInfo principal=tokenInfo.getPrincipal();
  if (principal == null) {
    return null;
  }
  if ((expected_principal_type != null) && !expected_principal_type.equals(principal.getType())) {
    return null;
  }
  return principal;
}

{
  logger.info("expected_token_type: {} exp.princ: {}",expected_token_type,expected_principal_type);
  TokenInfo tokenInfo=tokens.getTokenInfo(token);
  logger.info("tokenInfo: {} from token: type {}, principaltype: {}",new Object[]{tokenInfo,tokenInfo.getType(),tokenInfo.getPrincipal().getType()});
  if (tokenInfo == null) {
    return null;
  }
  if ((expected_token_type != null) && !expected_token_type.equals(tokenInfo.getType())) {
    return null;
  }
  AuthPrincipalInfo principal=tokenInfo.getPrincipal();
  if (principal == null) {
    return null;
  }
  if ((expected_principal_type != null) && !expected_principal_type.equals(principal.getType())) {
    return null;
  }
  return principal;
}

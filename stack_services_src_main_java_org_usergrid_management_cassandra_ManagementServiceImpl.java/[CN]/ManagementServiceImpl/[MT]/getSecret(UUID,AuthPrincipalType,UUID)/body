{
  if (AuthPrincipalType.ORGANIZATION.equals(type) || AuthPrincipalType.APPLICATION.equals(type)) {
    UUID ownerId=AuthPrincipalType.APPLICATION_USER.equals(type) ? applicationId : MANAGEMENT_APPLICATION_ID;
    return getCredentialsSecret(getCredentials(ownerId,id,USER_TOKEN));
  }
 else   if (AuthPrincipalType.ADMIN_USER.equals(type) || AuthPrincipalType.APPLICATION_USER.equals(type)) {
    return getCredentialsSecret(getCredentials(applicationId,id,USER_PASSWORD));
  }
  throw new IllegalArgumentException("Must specify an admin user, organization or application principal");
}

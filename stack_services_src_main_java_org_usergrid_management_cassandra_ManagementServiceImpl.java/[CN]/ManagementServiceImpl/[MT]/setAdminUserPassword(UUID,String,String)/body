{
  if ((userId == null) || (oldPassword == null) || (newPassword == null)) {
    return;
  }
  User user=emf.getEntityManager(MANAGEMENT_APPLICATION_ID).get(userId,User.class);
  if (!maybeSaltPassword(user,oldPassword).compare(readUserPasswordCredentials(MANAGEMENT_APPLICATION_ID,userId))) {
    logger.info("Old password doesn't match");
    throw new IncorrectPasswordException("Old password does not match");
  }
  setAdminUserPassword(userId,newPassword);
}

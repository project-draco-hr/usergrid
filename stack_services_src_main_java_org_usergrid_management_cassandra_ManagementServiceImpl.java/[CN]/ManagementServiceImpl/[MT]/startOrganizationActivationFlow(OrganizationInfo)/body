{
  try {
    String token=getActivationTokenForOrganization(organization.getUuid());
    String activation_url=String.format(properties.getProperty(PROPERTIES_ORGANIZATION_ACTIVATION_URL),organization.getUuid().toString()) + "?token=" + token;
    if (newOrganizationsNeedSysAdminApproval()) {
      List<UserInfo> users=getAdminUsersForOrganization(organization.getUuid());
      String organization_owners=null;
      for (      UserInfo user : users) {
        organization_owners=(organization_owners == null) ? user.getHTMLDisplayEmailAddress() : organization_owners + ", " + user.getHTMLDisplayEmailAddress();
      }
      sendHtmlMail(properties,getPropertyValue(PROPERTIES_SYSADMIN_EMAIL),getPropertyValue(PROPERTIES_MAILER_EMAIL),"Request For Organization Account Activation " + organization.getName(),appendEmailFooter(emailMsg(hashMap("organization_name",organization.getName()).map("activation_url",activation_url).map("organization_owners",organization_owners),PROPERTIES_EMAIL_SYSADMIN_ORGANIZATION_ACTIVATION)));
      sendOrganizationEmail(organization,"Organization Account Confirmed",emailMsg(hashMap("organization_name",organization.getName()),PROPERTIES_EMAIL_ORGANIZATION_CONFIRMED_AWAITING_ACTIVATION));
    }
 else {
      sendOrganizationEmail(organization,"Organization Account Confirmation",emailMsg(hashMap("organization_name",organization.getName()).map("activation_url",activation_url),PROPERTIES_EMAIL_ORGANIZATION_CONFIRMATION));
    }
  }
 catch (  Exception e) {
    logger.error("Unable to send activation emails to " + organization.getName(),e);
  }
}

{
  Lock groupLock=getUniqueUpdateLock(lockManager,MANAGEMENT_APPLICATION_ID,organizationName,"groups","path");
  Lock userLock=getUniqueUpdateLock(lockManager,MANAGEMENT_APPLICATION_ID,username,"users","username");
  Lock emailLock=getUniqueUpdateLock(lockManager,MANAGEMENT_APPLICATION_ID,email,"users","email");
  UserInfo user=null;
  OrganizationInfo organization=null;
  try {
    groupLock.lock();
    userLock.lock();
    emailLock.lock();
    if (areActivationChecksDisabled()) {
      user=createAdminUser(username,name,email,password,true,false);
    }
 else {
      user=createAdminUser(username,name,email,password,activated,disabled);
    }
    organization=createOrganization(organizationName,user,true);
  }
  finally {
    emailLock.unlock();
    userLock.unlock();
    groupLock.unlock();
  }
  return new OrganizationOwnerInfo(user,organization);
}

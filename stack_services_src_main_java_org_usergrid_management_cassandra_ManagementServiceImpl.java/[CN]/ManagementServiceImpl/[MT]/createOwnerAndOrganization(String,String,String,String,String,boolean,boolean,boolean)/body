{
  lockManager.lockProperty(MANAGEMENT_APPLICATION_ID,"groups","path");
  lockManager.lockProperty(MANAGEMENT_APPLICATION_ID,"users","username","email");
  EntityManager em=emf.getEntityManager(MANAGEMENT_APPLICATION_ID);
  UserInfo user=null;
  OrganizationInfo organization=null;
  try {
    if (!em.isPropertyValueUniqueForEntity("user","username",username)) {
      throw new DuplicateUniquePropertyExistsException("user","username",username);
    }
    if (!em.isPropertyValueUniqueForEntity("user","email",email)) {
      throw new DuplicateUniquePropertyExistsException("user","username",username);
    }
    if (!em.isPropertyValueUniqueForEntity("group","path",organizationName)) {
      throw new DuplicateUniquePropertyExistsException("group","path",organizationName);
    }
    user=createAdminUser(username,name,email,password,false,false,false);
    organization=createOrganization(organizationName,user);
    startOrganizationActivationFlow(organization);
  }
  finally {
    lockManager.unlockProperty(MANAGEMENT_APPLICATION_ID,"groups","path");
    lockManager.unlockProperty(MANAGEMENT_APPLICATION_ID,"users","username","email");
  }
  return new OrganizationOwnerInfo(user,organization);
}

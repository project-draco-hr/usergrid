{
  final long timeout=500;
  final TestEvent event=new TestEvent();
  final AsynchronousMessage<TestEvent> asynchronousMessage=new AsynchronousMessage<TestEvent>(){
    @Override public TestEvent getEvent(){
      return event;
    }
    @Override public long getTimeout(){
      return timeout;
    }
  }
;
  final TimeoutQueue queue=mock(TimeoutQueue.class);
  AsyncProcessor asyncProcessor=constructProcessor(queue);
  when(queue.queue(event,timeout)).thenReturn(asynchronousMessage);
  AsynchronousMessage<TestEvent> returned=asyncProcessor.setVerification(event,timeout);
  assertSame(asynchronousMessage,returned);
}

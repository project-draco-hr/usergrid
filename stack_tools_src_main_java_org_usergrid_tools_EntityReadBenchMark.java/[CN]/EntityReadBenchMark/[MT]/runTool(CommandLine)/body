{
  startSpring();
  logger.info("Starting entity cleanup");
  ExecutorService executors=Executors.newFixedThreadPool(WORKER_SIZE);
  int count=Integer.parseInt(line.getOptionValue("count"));
  int size=count / WORKER_SIZE;
  UUID appId=UUID.fromString(line.getOptionValue("appId"));
  System.out.println("Querying unique properties in the search index");
  Stack<Future<Void>> futures=new Stack<Future<Void>>();
  for (int i=0; i < WORKER_SIZE; i++) {
    futures.push(executors.submit(new IndexReadWorker(i,size,appId)));
  }
  ConsoleReporter.enable(5,TimeUnit.SECONDS);
  System.out.println("Waiting for index read workers to complete");
  while (!futures.isEmpty()) {
    futures.pop().get();
  }
  for (int i=0; i < WORKER_SIZE; i++) {
    futures.push(executors.submit(new DictReadWorker(i,size,appId)));
  }
  while (!futures.isEmpty()) {
    futures.pop().get();
  }
  System.out.println("All workers completed insertion");
  Thread.sleep(5000);
}

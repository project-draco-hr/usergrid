{
  startSpring();
  logger.info("Starting entity cleanup");
  ExecutorService executors=Executors.newFixedThreadPool(WORKER_SIZE);
  int count=Integer.parseInt(line.getOptionValue("count"));
  int size=count / WORKER_SIZE;
  UUID appId=UUID.fromString(line.getOptionValue("appId"));
  System.out.println("Querying unique properties in the search index");
  final ConsoleReporter reporter=new ConsoleReporter(Metrics.defaultRegistry(),System.out,MetricPredicate.ALL);
  reporter.start(30,TimeUnit.SECONDS);
  Stack<Future<Void>> futures=new Stack<Future<Void>>();
  System.out.println("Waiting for index read workers to complete");
  while (!futures.isEmpty()) {
    futures.pop().get();
  }
  for (int i=0; i < WORKER_SIZE; i++) {
    futures.push(executors.submit(new DictReadWorker(i,size,appId)));
  }
  while (!futures.isEmpty()) {
    futures.pop().get();
  }
  System.out.println("All workers completed reading");
  reporter.run();
}

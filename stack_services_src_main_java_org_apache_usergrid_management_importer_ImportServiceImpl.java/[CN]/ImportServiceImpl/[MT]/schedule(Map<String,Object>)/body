{
  if (config == null) {
    logger.error("import information cannot be null");
    return null;
  }
  EntityManager rootEm=null;
  try {
    rootEm=emf.getEntityManager(CpNamingUtils.MANAGEMENT_APPLICATION_ID);
    Set<String> collections=rootEm.getApplicationCollections();
    if (!collections.contains("imports")) {
      rootEm.createApplicationCollection("imports");
    }
  }
 catch (  Exception e) {
    logger.error("application doesn't exist within the current context");
    return null;
  }
  Import importUG=new Import();
  try {
    importUG=rootEm.create(importUG);
  }
 catch (  Exception e) {
    logger.error("Import entity creation failed");
    return null;
  }
  importUG.setState(Import.State.CREATED);
  rootEm.update(importUG);
  JobData jobData=new JobData();
  jobData.setProperty("importInfo",config);
  jobData.setProperty(IMPORT_ID,importUG.getUuid());
  long soonestPossible=System.currentTimeMillis() + 250;
  sch.createJob(IMPORT_JOB_NAME,soonestPossible,jobData);
  importUG.setState(Import.State.SCHEDULED);
  rootEm.update(importUG);
  return importUG.getUuid();
}

{
  logger.debug("Entering deleted for entity {}:{} v {} " + "scope\n   name: {}\n   owner: {}\n   app: {}",new Object[]{entity.getId().getType(),entity.getId().getUuid(),entity.getVersion(),scope.getName(),scope.getOwner(),scope.getApplication()});
  HybridEntityManagerFactory hemf=(HybridEntityManagerFactory)emf;
  CpEntityManagerFactory cpemf=(CpEntityManagerFactory)hemf.getImplementation();
  final EntityIndex ei=cpemf.getManagerCache().getEntityIndex(scope);
  if (System.getProperty("allow.stale.entities","false").equals("false")) {
    ei.deletePreviousVersions(entity.getId(),entity.getVersion());
  }
}

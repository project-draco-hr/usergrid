{
  logger.info("deleteEntity {} of application {}",entityId,applicationId);
  DynamicEntity entity=loadPartialEntity(entityId);
  if (entity == null) {
    return;
  }
  logger.info("deleteEntity: {} is of type {}",entityId,entity.getType());
  Keyspace ko=cass.getApplicationKeyspace(applicationId);
  Mutator<ByteBuffer> m=createMutator(ko,be);
  UUID timestampUuid=newTimeUUID();
  long timestamp=getTimestampInMicros(timestampUuid);
  getRelationManager(ref(entityId)).batchDisconnect(m,timestampUuid);
  Set<String> properties=getPropertyNames(entity);
  if (properties != null) {
    for (    String propertyName : properties) {
      m=batchSetProperty(m,entity,propertyName,null,true,false,timestampUuid);
    }
  }
  Set<String> dictionaries=getDictionaryNames(entity);
  if (dictionaries != null) {
    for (    String dictionary : dictionaries) {
      Set<Object> values=getDictionaryAsSet(entity,dictionary);
      if (values != null) {
        for (        Object value : values) {
          batchUpdateDictionary(m,entity,dictionary,value,true,timestampUuid);
        }
      }
    }
  }
  getRelationManager(entity).batchRemoveFromContainers(m,timestampUuid);
  batchExecute(m,CassandraService.RETRY_COUNT);
  timestamp+=1;
  if (dictionaries != null) {
    for (    String dictionary : dictionaries) {
      cass.deleteRow(ko,getDefaultSchema().hasDictionary(entity.getType(),dictionary) ? ENTITY_DICTIONARIES : ENTITY_COMPOSITE_DICTIONARIES,key(entity.getUuid(),dictionary),timestamp);
    }
  }
  cass.deleteRow(ko,ENTITY_PROPERTIES,key(entityId),timestamp);
  deleteAliasesForEntity(entityId,timestamp);
}

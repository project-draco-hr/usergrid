{
  UUID entityId=ref.getUuid();
  String entityType=ref.getType();
  if (entityType == null) {
    entityType=getEntityType(entityId);
  }
  if (entityType == null) {
    return null;
  }
  if (aliasType == null) {
    aliasType=entityType;
  }
  if (ownerId == null) {
    ownerId=applicationId;
  }
  if (alias == null) {
    return null;
  }
  alias=alias.toLowerCase().trim();
  UUID keyId=CassandraPersistenceUtils.aliasID(ownerId,aliasType,alias);
  Keyspace ko=cass.getApplicationKeyspace(applicationId);
  Mutator<ByteBuffer> m=createMutator(ko,be);
  long timestamp=cass.createTimestamp();
  addInsertToMutator(m,ApplicationCF.ENTITY_ALIASES,keyId,"entityId",entityId,timestamp);
  addInsertToMutator(m,ENTITY_ALIASES,keyId,"entityType",entityType,timestamp);
  addInsertToMutator(m,ENTITY_ALIASES,keyId,"aliasType",aliasType,timestamp);
  addInsertToMutator(m,ENTITY_ALIASES,keyId,"alias",alias,timestamp);
  batchExecute(m,CassandraService.RETRY_COUNT);
  return keyId;
}

{
  final EdgeRowKey edgeRowKey=new EdgeRowKey(key.getNodeId(),key.getEdgeTypes());
  final ScopedRowKey rowKey=ScopedRowKey.fromKey(key.getScope(),edgeRowKey);
  try {
    OperationResult<Column<Long>> column=keyspace.prepareQuery(EDGE_SHARD_COUNTS).getKey(rowKey).getColumn(key.getShardId()).execute();
    return column.getResult().getLongValue();
  }
 catch (  NotFoundException nfe) {
    return 0;
  }
catch (  ConnectionException e) {
    throw new GraphRuntimeException("An error occurred connecting to cassandra",e);
  }
}

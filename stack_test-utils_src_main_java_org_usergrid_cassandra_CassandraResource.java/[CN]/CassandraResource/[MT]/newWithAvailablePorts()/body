{
  int rpcPort=AvailablePortFinder.getNextAvailable(CassandraResource.DEFAULT_RPC_PORT + RandomUtils.nextInt(1000));
  int storagePort=AvailablePortFinder.getNextAvailable(CassandraResource.DEFAULT_STORAGE_PORT + RandomUtils.nextInt(1000));
  int sslStoragePort=AvailablePortFinder.getNextAvailable(CassandraResource.DEFAULT_SSL_STORAGE_PORT + RandomUtils.nextInt(1000));
  if (rpcPort == storagePort) {
    storagePort++;
    storagePort=AvailablePortFinder.getNextAvailable(storagePort);
  }
  if (sslStoragePort == storagePort) {
    sslStoragePort++;
    sslStoragePort=AvailablePortFinder.getNextAvailable(sslStoragePort);
  }
  try {
    return new CassandraResource(rpcPort,storagePort,sslStoragePort);
  }
 catch (  IOException e) {
    LOG.error("Failed to initialized CassandraResource",e);
    throw new RuntimeException(e);
  }
}

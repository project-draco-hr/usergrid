{
  logger.info("New user for organization: " + username + " ("+ email+ ")");
  ApiResponse response=createApiResponse();
  response.setAction("create user");
  UserInfo user=null;
  if (invite) {
    user=management.getAdminUserByEmail(email);
  }
  if (user == null) {
    user=management.createAdminUser(username,name,email,password,false,false);
    if (user != null) {
      management.startAdminUserPasswordResetFlow(user);
    }
  }
  if (user == null) {
    return null;
  }
  management.addAdminUserToOrganization(user,organization,true);
  Map<String,Object> result=new LinkedHashMap<String,Object>();
  result.put("user",user);
  response.setData(result);
  response.setSuccess();
  return new JSONWithPadding(response,callback);
}

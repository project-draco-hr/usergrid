{
  EntityManager rootEm=emf.getEntityManager(MANAGEMENT_APPLICATION_ID);
  try {
    Entity entity=em.create(entityUuid,entityType,properties);
    if (entity != null) {
      entityCount++;
      logger.error(entityCount + "");
      if ((entityCount % 10) == 0) {
        jobExecution.heartbeat();
      }
      if (entityCount == 2000) {
        logger.error("updated entity count");
        fileImport.setLastUpdatedUUID(entity.getUuid().toString());
        rootEm.update(fileImport);
        logger.error("updated entity count for file " + fileImport.getFileName());
        entityCount=0;
      }
    }
  }
 catch (  Exception e) {
    logger.error("something went wrong while creating this - " + e);
    fileImport.setErrorMessage(e.getMessage());
    try {
      rootEm.update(fileImport);
    }
 catch (    Exception ex) {
    }
  }
}

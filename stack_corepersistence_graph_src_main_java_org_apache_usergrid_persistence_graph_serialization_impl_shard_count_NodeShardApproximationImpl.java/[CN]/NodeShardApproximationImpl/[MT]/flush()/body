{
  final Counter toFlush;
  writeLockLock.lock();
  try {
    toFlush=currentCounter;
    currentCounter=new Counter();
  }
  finally {
    writeLockLock.unlock();
  }
  final MutationBatch batch=nodeShardCounterSerialization.flush(toFlush);
  new HystrixCommand(HystrixCassandra.ASYNC_GROUP){
    @Override protected Void run() throws Exception {
      batch.execute();
      return null;
    }
    @Override protected Object getFallback(){
      currentCounter.merge(toFlush);
      return null;
    }
  }
.execute();
}

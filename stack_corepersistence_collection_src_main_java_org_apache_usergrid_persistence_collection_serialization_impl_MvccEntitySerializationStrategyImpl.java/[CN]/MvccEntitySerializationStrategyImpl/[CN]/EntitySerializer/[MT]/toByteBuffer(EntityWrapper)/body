{
  if (wrapper == null) {
    return null;
  }
  CompositeBuilder builder=Composites.newCompositeBuilder();
  builder.addBytes(VERSION);
  f.disable(SmileParser.Feature.REQUIRE_HEADER);
  mapper=new ObjectMapper(f);
  if (!wrapper.entity.isPresent()) {
    builder.addBytes(STATE_DELETED);
    return builder.build();
  }
  if (wrapper.status == MvccEntity.Status.COMPLETE) {
    builder.addBytes(STATE_COMPLETE);
  }
 else {
    builder.addBytes(STATE_PARTIAL);
  }
  try {
    builder.addBytes(mapper.writeValueAsBytes(wrapper.entity.get()));
  }
 catch (  JsonMappingException e) {
    e.printStackTrace();
  }
catch (  JsonGenerationException e) {
    e.printStackTrace();
  }
catch (  IOException e) {
    e.printStackTrace();
  }
  return builder.build();
}

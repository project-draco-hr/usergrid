{
  Queue queue=context.application().queues().queue("test");
  final int count=30;
  for (int i=0; i < count; i++) {
    Map<String,Object> data=new HashMap<String,Object>();
    data.put("name","todd");
    data.put("id",i);
    data.put("indexed",true);
    queue.post(data);
  }
  queue=queue.withLimit(1).withPosition(QueuePosition.START.name()).withFilters("name = 'todd'","id >= 10","id <= 20").withLast(null);
  ForwardMatchHandler handler=new ForwardMatchHandler(10,10);
  testMessages(queue,handler);
  handler.assertResults();
  handler=new ForwardMatchHandler(10,10);
  testMessages(queue,handler);
  handler.assertResults();
}

{
  Id orgId;
  EntityCollectionManager ecm=getManager(SYSTEM_APP_SCOPE);
  EntityCollectionIndex eci=getIndex(SYSTEM_APP_SCOPE);
  String orgName=getApplication().getOrganizationName();
  org.apache.usergrid.persistence.index.query.Query q=org.apache.usergrid.persistence.index.query.Query.fromQL("name = '" + orgName + "'");
  org.apache.usergrid.persistence.index.query.Results results=eci.execute(q);
  if (results.isEmpty()) {
    org.apache.usergrid.persistence.model.entity.Entity entity=new org.apache.usergrid.persistence.model.entity.Entity(new SimpleId(UUIDGenerator.newTimeUUID(),"organization"));
    entity.setField(new StringField("name",orgName));
    entity=ecm.write(entity).toBlockingObservable().last();
    log.debug("Added record for org name {}",orgName);
    orgId=entity.getId();
  }
 else {
    org.apache.usergrid.persistence.model.entity.Entity entity=results.getEntities().get(0);
    orgId=entity.getId();
  }
  return orgId;
}

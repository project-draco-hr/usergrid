{
  ValidationUtils.validateOrganizationScope(scope);
  EdgeUtils.validateEdge(edge);
  final Id sourceNodeId=edge.getSourceNode();
  final Id targetNodeId=edge.getTargetNode();
  final UUID version=edge.getVersion();
  final String type=edge.getType();
  final RowKey sourceRowKey=new RowKey(sourceNodeId,type,edgeShardStrategy.getWriteShard(scope,sourceNodeId,version,type));
  final RowKeyType sourceRowKeyType=new RowKeyType(sourceNodeId,type,targetNodeId,edgeShardStrategy.getWriteShard(scope,sourceNodeId,version,type,targetNodeId.getType()));
  final DirectedEdge sourceEdge=new DirectedEdge(targetNodeId,version);
  final RowKey targetRowKey=new RowKey(targetNodeId,type,edgeShardStrategy.getWriteShard(scope,targetNodeId,version,type));
  final RowKeyType targetRowKeyType=new RowKeyType(targetNodeId,type,sourceNodeId,edgeShardStrategy.getWriteShard(scope,targetNodeId,version,type,sourceNodeId.getType()));
  final DirectedEdge targetEdge=new DirectedEdge(sourceNodeId,version);
  final EdgeRowKey edgeRowKey=new EdgeRowKey(sourceNodeId,type,targetNodeId,edgeShardStrategy.getWriteShard(scope,sourceNodeId,version,type,targetNodeId.getUuid().toString(),targetNodeId.getType()));
  op.writeEdge(GRAPH_SOURCE_NODE_EDGES,sourceRowKey,sourceEdge);
  op.writeEdge(GRAPH_SOURCE_NODE_TARGET_TYPE,sourceRowKeyType,sourceEdge);
  op.writeEdge(GRAPH_TARGET_NODE_EDGES,targetRowKey,targetEdge);
  op.writeEdge(GRAPH_TARGET_NODE_SOURCE_TYPE,targetRowKeyType,targetEdge);
  op.writeVersion(GRAPH_EDGE_VERSIONS,edgeRowKey,version);
}

{
  ValidationUtils.validateOrganizationScope(scope);
  EdgeUtils.validateSearchByEdge(search);
  final Id sourceId=search.sourceNode();
  final Id targetId=search.targetNode();
  final UUID maxVersion=search.getMaxVersion();
  final String type=search.getType();
  return getEdges(GRAPH_TARGET_NODE_EDGES,new EdgeSearcher<RowKey>(scope,search.last()){
    @Override public void setRange(    final RangeBuilder builder){
      if (last.isPresent()) {
        super.setRange(builder);
        return;
      }
      final DirectedEdge colValue=new DirectedEdge(sourceId,maxVersion);
      builder.setStart(colValue,EDGE_SERIALIZER);
    }
    @Override protected RowKey generateRowKey(){
      return new RowKey(targetId,type);
    }
    @Override protected DirectedEdge getStartColumn(    final Edge last){
      return new DirectedEdge(last.getSourceNode(),last.getVersion());
    }
    @Override protected MarkedEdge createEdge(    final DirectedEdge edge,    final boolean marked){
      return new SimpleMarkedEdge(edge.id,type,targetId,edge.version,marked);
    }
  }
);
}

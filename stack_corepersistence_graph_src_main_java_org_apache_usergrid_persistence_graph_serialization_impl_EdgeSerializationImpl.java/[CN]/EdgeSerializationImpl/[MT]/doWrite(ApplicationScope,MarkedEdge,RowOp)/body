{
  ValidationUtils.validateApplicationScope(scope);
  EdgeUtils.validateEdge(edge);
  final Id sourceNodeId=edge.getSourceNode();
  final String souceNodeType=sourceNodeId.getType();
  final Id targetNodeId=edge.getTargetNode();
  final String targetNodeType=targetNodeId.getType();
  final long timestamp=edge.getTimestamp();
  final String type=edge.getType();
  final long sourceRowKeyShard=edgeShardStrategy.getWriteShard(scope,sourceNodeId,timestamp,type);
  final RowKey sourceRowKey=new RowKey(sourceNodeId,type,sourceRowKeyShard);
  final long sourceWithTypeRowKeyShard=edgeShardStrategy.getWriteShard(scope,sourceNodeId,timestamp,type,targetNodeType);
  final RowKeyType sourceRowKeyType=new RowKeyType(sourceNodeId,type,targetNodeId,sourceWithTypeRowKeyShard);
  final DirectedEdge sourceEdge=new DirectedEdge(targetNodeId,timestamp);
  final long targetRowKeyShard=edgeShardStrategy.getWriteShard(scope,targetNodeId,timestamp,type);
  final RowKey targetRowKey=new RowKey(targetNodeId,type,targetRowKeyShard);
  final long targetWithTypeRowKeyShard=edgeShardStrategy.getWriteShard(scope,targetNodeId,timestamp,type,souceNodeType);
  final RowKeyType targetRowKeyType=new RowKeyType(targetNodeId,type,sourceNodeId,targetWithTypeRowKeyShard);
  final DirectedEdge targetEdge=new DirectedEdge(sourceNodeId,timestamp);
  final EdgeRowKey edgeRowKey=new EdgeRowKey(sourceNodeId,type,targetNodeId,edgeShardStrategy.getWriteShard(scope,sourceNodeId,timestamp,type,targetNodeId.getUuid().toString(),targetNodeId.getType()));
  op.writeEdge(sourceNodeEdgesCf,sourceRowKey,sourceEdge);
  op.countEdge(sourceNodeId,sourceRowKeyShard,type);
  op.writeEdge(sourceNodeTargetTypeCf,sourceRowKeyType,sourceEdge);
  op.countEdge(sourceNodeId,sourceWithTypeRowKeyShard,type,targetNodeType);
  op.writeEdge(targetNodeEdgesCf,targetRowKey,targetEdge);
  op.countEdge(targetNodeId,targetRowKeyShard,type);
  op.writeEdge(targetNodeSourceTypeCf,targetRowKeyType,targetEdge);
  op.countEdge(targetNodeId,targetWithTypeRowKeyShard,type,souceNodeType);
  op.writeVersion(graphEdgeVersionsCf,edgeRowKey,timestamp);
}

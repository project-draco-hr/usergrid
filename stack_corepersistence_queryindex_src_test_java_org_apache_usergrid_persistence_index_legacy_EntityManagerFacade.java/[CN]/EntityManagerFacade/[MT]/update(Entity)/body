{
  String type=entity.getId().getType();
  CollectionScope scope=new CollectionScopeImpl(appId,orgId,type);
  EntityCollectionManager ecm=ecmf.createCollectionManager(scope);
  EntityCollectionIndex eci=ecif.createCollectionIndex(scope);
  final String collectionName;
  if (type.endsWith("y")) {
    collectionName=type.substring(0,type.length() - 1) + "ies";
  }
 else {
    collectionName=type + "s";
  }
  typesByCollectionNames.put(collectionName,type);
  entity=ecm.write(entity).toBlockingObservable().last();
  eci.index(entity);
}

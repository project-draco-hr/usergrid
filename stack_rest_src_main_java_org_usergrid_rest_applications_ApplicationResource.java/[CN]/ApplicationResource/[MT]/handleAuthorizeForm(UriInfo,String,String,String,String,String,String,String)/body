{
  try {
    responseType=response_type;
    clientId=client_id;
    redirectUri=redirect_uri;
    this.scope=scope;
    this.state=state;
    User user=null;
    try {
      user=management.verifyAppUserPasswordCredentials(services.getApplicationId(),username,password);
    }
 catch (    Exception e1) {
    }
    if ((user != null) && isNotBlank(redirect_uri)) {
      if (!redirect_uri.contains("?")) {
        redirect_uri+="?";
      }
 else {
        redirect_uri+="&";
      }
      redirect_uri+="code=" + management.getAccessTokenForAppUser(services.getApplicationId(),user.getUuid());
      if (isNotBlank(state)) {
        redirect_uri+="&state=" + URLEncoder.encode(state,"UTF-8");
      }
      throw new WebApplicationException(temporaryRedirect(new URI(state)).build());
    }
 else {
      errorMsg="Username or password do not match";
    }
    ApplicationInfo app=management.getApplication(applicationId);
    applicationName=app.getName();
    return new Viewable("authorize_form",this);
  }
 catch (  Exception e) {
    return new Viewable("error",e);
  }
}

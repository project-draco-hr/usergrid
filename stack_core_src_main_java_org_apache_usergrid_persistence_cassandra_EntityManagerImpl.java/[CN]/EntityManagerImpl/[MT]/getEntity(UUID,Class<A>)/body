{
  Object entity_key=key(entityId);
  Map<String,Object> results=null;
  results=deserializeEntityProperties(cass.getAllColumns(cass.getApplicationKeyspace(applicationId),ENTITY_PROPERTIES,entity_key));
  if (results == null) {
    logger.warn("getEntity(): No properties found for entity {}, " + "probably doesn't exist...",entityId);
    return null;
  }
  UUID id=uuid(results.get(PROPERTY_UUID));
  String type=string(results.get(PROPERTY_TYPE));
  if (!entityId.equals(id)) {
    logger.error("Expected entity id {}, found {}. Returning null entity",new Object[]{entityId,id,new Throwable()});
    return null;
  }
  A entity=EntityFactory.newEntity(id,type,entityClass);
  entity.setProperties(results);
  return entity;
}

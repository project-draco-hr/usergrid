{
  File f=null;
  try {
    f=new File("exportOneOrg.json");
    f.delete();
  }
 catch (  Exception e) {
  }
  setup.getMgmtSvc().createOwnerAndOrganization("noExport","junkUserName","junkRealName","ugExport@usergrid.com","123456789");
  S3Export s3Export=new MockS3ExportImpl();
  s3Export.setFilename("exportOneOrg.json");
  ExportService exportService=setup.getExportService();
  HashMap<String,Object> payload=payloadBuilder();
  ExportInfo exportInfo=new ExportInfo(payload);
  exportInfo.setOrganizationId(organization.getUuid());
  exportInfo.setApplicationId(applicationId);
  exportInfo.setCollection("roles");
  UUID exportUUID=exportService.schedule(exportInfo);
  exportService.setS3Export(s3Export);
  JobData jobData=new JobData();
  jobData.setProperty("jobName","exportJob");
  jobData.setProperty("exportInfo",exportInfo);
  jobData.setProperty("exportId",exportUUID);
  JobExecution jobExecution=mock(JobExecution.class);
  when(jobExecution.getJobData()).thenReturn(jobData);
  exportService.doExport(exportInfo,jobExecution);
  JSONParser parser=new JSONParser();
  org.json.simple.JSONArray a=(org.json.simple.JSONArray)parser.parse(new FileReader(f));
  assertEquals(3,a.size());
  for (int i=0; i < a.size(); i++) {
    org.json.simple.JSONObject entity=(org.json.simple.JSONObject)a.get(i);
    org.json.simple.JSONObject entityData=(JSONObject)entity.get("Metadata");
    String entityName=(String)entityData.get("name");
    assertFalse("junkRealName".equals(entityName));
  }
  f.delete();
}

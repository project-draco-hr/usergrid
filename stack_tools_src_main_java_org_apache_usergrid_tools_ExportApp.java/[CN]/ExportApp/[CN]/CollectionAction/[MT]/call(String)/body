{
  EntityOnSubscribe onSubscribe=new EntityOnSubscribe(em,collection);
  rx.Observable entityObservable=rx.Observable.create(onSubscribe);
  entityObservable.flatMap(new Func1<ExportEntity,Observable<ExportEntity>>(){
    public Observable<ExportEntity> call(    ExportEntity exportEntity){
      return Observable.just(exportEntity).doOnNext(new EntityAction(em)).subscribeOn(readScheduler);
    }
  }
,8).subscribeOn(readScheduler).toBlocking().last();
}

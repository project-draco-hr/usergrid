{
  String lockPath=LockPathBuilder.buildPath(applicationId,path);
  ReentrantLock lock=globalLocks.get(lockPath);
  if (lock == null) {
synchronized (this) {
      lock=globalLocks.get(lockPath);
      if (lock == null) {
        lock=new ReentrantLock();
        globalLocks.put(lockPath,lock);
      }
    }
  }
  return new SingleNodeLockImpl(lock);
}

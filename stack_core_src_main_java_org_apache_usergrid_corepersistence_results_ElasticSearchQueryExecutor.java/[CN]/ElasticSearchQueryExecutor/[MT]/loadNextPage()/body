{
  final int maxQueries=10;
  final int originalLimit=query.getLimit();
  Results results=null;
  int queryCount=0;
  boolean satisfied=false;
  while (!satisfied && queryCount++ < maxQueries) {
    CandidateResults crs=entityIndex.search(indexScope,types,query);
    logger.debug("Calling build results 1");
    results=buildResults(indexScope,query,crs);
    if (crs.isEmpty() || !crs.hasCursor()) {
      satisfied=true;
    }
 else     if (results.size() > 0) {
      satisfied=true;
    }
 else     if (crs.hasCursor()) {
      satisfied=false;
      query.setCursor(results.getCursor());
      query.setLimit(originalLimit - results.size());
      logger.warn("Satisfy query limit {}, new limit {} query count {}",new Object[]{originalLimit,query.getLimit(),queryCount});
    }
  }
  if (results.hasCursor()) {
    query.setCursor(results.getCursor());
    moreToLoad=true;
  }
 else {
    moreToLoad=false;
  }
  this.currentResults=results;
}

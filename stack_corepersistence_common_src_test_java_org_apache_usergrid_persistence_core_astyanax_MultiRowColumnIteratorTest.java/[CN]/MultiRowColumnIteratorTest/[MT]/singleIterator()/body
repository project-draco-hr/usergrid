{
  final String rowKey1=UUIDGenerator.newTimeUUID().toString();
  final long maxValue=10000;
  Observable.just(rowKey1).parallel(new Func1<Observable<String>,Observable<String>>(){
    @Override public Observable<String> call(    final Observable<String> stringObservable){
      return stringObservable.doOnNext(new Action1<String>(){
        @Override public void call(        final String key){
          final MutationBatch batch=keyspace.prepareMutationBatch();
          for (long i=0; i < maxValue; i++) {
            batch.withRow(COLUMN_FAMILY,key).putColumn(i,TRUE);
            if (i % 1000 == 0) {
              try {
                batch.execute();
              }
 catch (              ConnectionException e) {
                throw new RuntimeException(e);
              }
            }
          }
          try {
            batch.execute();
          }
 catch (          ConnectionException e) {
            throw new RuntimeException(e);
          }
        }
      }
);
    }
  }
).toBlocking().last();
  final ColumnParser<Long,Long> longParser=new ColumnParser<Long,Long>(){
    @Override public Long parseColumn(    final Column<Long> column){
      return column.getName();
    }
  }
;
  final ColumnSearch<Long> ascendingSearch=new ColumnSearch<Long>(){
    @Override public void buildRange(    final RangeBuilder rangeBuilder,    final Long value){
      rangeBuilder.setStart(value);
    }
    @Override public void buildRange(    final RangeBuilder rangeBuilder){
    }
    @Override public boolean skipFirst(    final Long first){
      return false;
    }
  }
;
  final Comparator<Long> ascendingComparator=new Comparator<Long>(){
    @Override public int compare(    final Long o1,    final Long o2){
      return Long.compare(o1,o2);
    }
  }
;
  final Collection<String> rowKeys=Arrays.asList(rowKey1);
  MultiRowColumnIterator<String,Long,Long> ascendingItr=new MultiRowColumnIterator<>(keyspace,COLUMN_FAMILY,ConsistencyLevel.CL_QUORUM,longParser,ascendingSearch,ascendingComparator,rowKeys,712);
  for (long i=0; i < maxValue; i++) {
    assertEquals(i,ascendingItr.next().longValue());
  }
  final ColumnSearch<Long> descendingSearch=new ColumnSearch<Long>(){
    @Override public void buildRange(    final RangeBuilder rangeBuilder,    final Long value){
      rangeBuilder.setStart(value);
      buildRange(rangeBuilder);
    }
    @Override public void buildRange(    final RangeBuilder rangeBuilder){
      rangeBuilder.setReversed(true);
    }
    @Override public boolean skipFirst(    final Long first){
      return false;
    }
  }
;
  final Comparator<Long> descendingComparator=new Comparator<Long>(){
    @Override public int compare(    final Long o1,    final Long o2){
      return ascendingComparator.compare(o1,o2) * -1;
    }
  }
;
  MultiRowColumnIterator<String,Long,Long> descendingItr=new MultiRowColumnIterator<>(keyspace,COLUMN_FAMILY,ConsistencyLevel.CL_QUORUM,longParser,descendingSearch,descendingComparator,rowKeys,712);
  for (long i=maxValue - 1; i > -1; i--) {
    assertEquals(i,descendingItr.next().longValue());
  }
}

{
  final long waitTime=Math.min(idleTime,WAIT_MAX_MILLIS);
  long lastChangeTime=System.currentTimeMillis();
  long timeNotChanged=0;
  int currentCount;
  int startCount=getDoneCount();
  do {
    currentCount=getDoneCount();
    if (startCount == currentCount) {
      if (timeNotChanged > idleTime) {
        return false;
      }
      timeNotChanged=System.currentTimeMillis() - lastChangeTime;
    }
 else {
      timeNotChanged=0;
      startCount=currentCount;
      lastChangeTime=System.currentTimeMillis();
    }
synchronized (lock) {
      lock.wait(waitTime);
    }
  }
 while (currentCount < jobCount);
  return true;
}

{
  int size=0;
  EntityManager em=emf.getEntityManager(smf.getManagementAppId());
  Results orgResults=em.getCollection(new SimpleEntityRef(User.ENTITY_TYPE,userId),"groups",null,10000,Level.REFS,false);
  for (  EntityRef orgRef : orgResults.getRefs()) {
    Map properties=em.getDictionaryAsMap(orgRef,ORGANIZATION_PROPERTIES_DICTIONARY);
    if (properties != null) {
      size=Math.max(new OrganizationInfo(null,null,properties).getPasswordHistorySize(),size);
    }
  }
  return size;
}

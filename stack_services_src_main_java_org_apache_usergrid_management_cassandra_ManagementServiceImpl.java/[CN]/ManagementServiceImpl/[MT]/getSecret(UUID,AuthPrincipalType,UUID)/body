{
  if (AuthPrincipalType.ORGANIZATION.equals(type) || AuthPrincipalType.APPLICATION.equals(type)) {
    UUID ownerId=AuthPrincipalType.APPLICATION_USER.equals(type) ? applicationId : smf.getManagementAppId();
    return getCredentialsSecret(readUserToken(ownerId,id));
  }
 else   if (AuthPrincipalType.ADMIN_USER.equals(type) || AuthPrincipalType.APPLICATION_USER.equals(type)) {
    return getCredentialsSecret(readUserPasswordCredentials(applicationId,id));
  }
  throw new IllegalArgumentException("Must specify an admin user, organization or application principal");
}

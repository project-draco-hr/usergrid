{
  AuthPrincipalInfo principal=getPrincipalFromAccessToken(token,TOKEN_TYPE_CONFIRM,ADMIN_USER);
  if ((principal != null) && userId.equals(principal.getUuid())) {
    UserInfo user=getAdminUserByUuid(principal.getUuid());
    confirmAdminUser(user.getUuid());
    if (newAdminUsersNeedSysAdminApproval()) {
      sendAdminUserConfirmedAwaitingActivationEmail(user);
      sendSysAdminRequestAdminActivationEmail(user);
      return ActivationState.CONFIRMED_AWAITING_ACTIVATION;
    }
 else {
      activateAdminUser(principal.getUuid());
      sendAdminUserActivatedEmail(user);
      sendSysAdminNewAdminActivatedNotificationEmail(user);
      return ActivationState.ACTIVATED;
    }
  }
  return ActivationState.UNKNOWN;
}

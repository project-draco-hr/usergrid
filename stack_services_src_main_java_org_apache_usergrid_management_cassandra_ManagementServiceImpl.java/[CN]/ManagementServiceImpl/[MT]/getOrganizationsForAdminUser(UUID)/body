{
  if (userId == null) {
    return null;
  }
  BiMap<UUID,String> organizations=HashBiMap.create();
  EntityManager em=emf.getEntityManager(smf.getManagementAppId());
  Results results=em.getCollection(new SimpleEntityRef(User.ENTITY_TYPE,userId),Schema.COLLECTION_GROUPS,null,1000,Level.ALL_PROPERTIES,false);
  do {
    for (    Entity entity : results.getEntities()) {
      String path=(String)entity.getProperty(PROPERTY_PATH);
      if (path != null) {
        path=path.toLowerCase();
      }
      try {
        organizations.put(entity.getUuid(),path);
      }
 catch (      IllegalArgumentException e) {
        logger.warn("Error adding " + entity.getUuid() + ":"+ path+ " to BiMap: "+ e.getMessage());
      }
    }
    results=results.hasMoreResults() ? results.getNextPageResults() : null;
  }
 while (results != null);
  return organizations;
}

{
  app.clear();
  app.put("provider","google");
  app.put("environment","xxx");
  try {
    app.testRequest(ServiceAction.POST,1,"notifiers");
    fail("notifier creation should have failed with missing apiKey");
  }
 catch (  RequiredPropertyNotFoundException e) {
  }
  ns.providerAdapters.put("google",new org.apache.usergrid.notifications.gcm.MockSuccessfulProviderAdapter(){
    @Override public void testConnection(    Notifier notifier) throws ConnectionException {
      throw new ConnectionException("",null);
    }
  }
);
  app.put("apiKey","xxx");
  try {
    app.testRequest(ServiceAction.POST,1,"notifiers");
    fail("notifier creation should have failed with bad connection");
  }
 catch (  ConnectionException e) {
  }
}

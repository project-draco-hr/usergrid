{
  CustomCollection things=context.application().collection("things1");
  int size=40;
  List<Map<String,String>> created=new ArrayList<Map<String,String>>(size);
  for (int i=0; i < size; i++) {
    Map<String,String> entity=hashMap("name",String.valueOf(i));
    things.create(entity);
    created.add(entity);
  }
  refreshIndex(context.getOrgName(),context.getAppName());
  ApiResponse response=null;
  Iterator<Map<String,String>> entityItr=created.iterator();
  do {
    response=parse(things.get());
    for (    Entity e : response.getEntities()) {
      assertTrue(entityItr.hasNext());
      assertEquals(entityItr.next().get("name"),e.getProperties().get("name").asText());
      logger.debug("Got item value {}",e.getProperties().get("name").asText());
    }
    logger.debug("response cursor: " + response.getCursor());
    things=things.withCursor(response.getCursor());
  }
 while (response != null && response.getCursor() != null);
  assertFalse("Should have paged them all",entityItr.hasNext());
}

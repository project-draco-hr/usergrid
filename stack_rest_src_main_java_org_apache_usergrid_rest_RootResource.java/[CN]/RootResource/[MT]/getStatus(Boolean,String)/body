{
  ApiResponse response=createApiResponse();
  QueueManagerFactory queueManagerFactory=injector.getInstance(QueueManagerFactory.class);
  QueueScope queueScope=new QueueScopeImpl("es_queue",QueueScope.RegionImplementation.ALLREGIONS);
  QueueManager queue=queueManagerFactory.getQueueManager(queueScope);
  if (!ignoreError) {
    if (!emf.getEntityStoreHealth().equals(Health.GREEN)) {
      throw new RuntimeException("Error connecting to datastore");
    }
    if (emf.getIndexHealth().equals(Health.RED)) {
      throw new RuntimeException("Management app index is status RED");
    }
  }
  ObjectNode node=JsonNodeFactory.instance.objectNode();
  node.put("started",started);
  node.put("uptime",System.currentTimeMillis() - started);
  node.put("version",usergridSystemMonitor.getBuildNumber());
  node.put("cassandraAvailable",usergridSystemMonitor.getIsCassandraAlive());
  node.put("cassandraStatus",emf.getEntityStoreHealth().toString());
  node.put("managementAppIndexStatus",emf.getIndexHealth().toString());
  node.put("queueDepth",queue.getQueueDepth());
  dumpMetrics(node);
  response.setProperty("status",node);
  return new JSONWithPadding(response,callback);
}

{
  GraphManager gm=emf.createEdgeManager(scope);
  final Id targetId=createId("target");
  final String edgeType="test";
  final long flushCount=graphFig.getCounterFlushCount();
  final long maxShardSize=graphFig.getShardSize();
  final long startTime=System.currentTimeMillis();
  final long writeCount=flushCount / 4;
  assertTrue("Shard size must be >= flush Count",maxShardSize >= flushCount);
  Id sourceId=null;
  for (long i=0; i < writeCount; i++) {
    sourceId=createId("source");
    final Edge edge=createEdge(sourceId,edgeType,targetId);
    gm.writeEdge(edge).toBlocking().last();
  }
  long shardCount=nodeShardApproximation.getCount(scope,targetId,0l,edgeType);
  assertEquals("Shard count for source node should be the same as write count",writeCount,shardCount);
  shardCount=nodeShardApproximation.getCount(scope,sourceId,0l,edgeType);
  assertEquals(1,shardCount);
}

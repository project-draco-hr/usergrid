{
  if (logger.isTraceEnabled()) {
    logger.trace("Filtering: {}",request.getUriInfo().getBaseUri());
  }
  Map<String,String> auth_types=getAuthTypes(request);
  if ((auth_types == null) || !auth_types.containsKey(AUTH_BASIC_TYPE)) {
    return;
  }
  String[] values=Base64.decodeToString(auth_types.get(AUTH_BASIC_TYPE)).split(":");
  if (values.length < 2) {
    return;
  }
  String name=values[0].toLowerCase();
  String password=values[1];
  String sysadmin_login_name=properties.getProperty("usergrid.sysadmin.login.name");
  String sysadmin_login_password=properties.getProperty("usergrid.sysadmin.login.password");
  boolean sysadmin_login_allowed=Boolean.parseBoolean(properties.getProperty("usergrid.sysadmin.login.allowed"));
  boolean sysadmin_localhost_only=Boolean.parseBoolean(properties.getProperty("usergrid.sysadmin.localhost.only","false"));
  boolean is_localhost=false;
  try {
    is_localhost=InetAddress.getByName(request.getUriInfo().getBaseUri().getHost()).isLoopbackAddress();
  }
 catch (  Exception e) {
  }
  boolean password_match=password.equals(sysadmin_login_password);
  if (name.equals(sysadmin_login_name) && (password_match || is_localhost) && sysadmin_login_allowed&& (is_localhost || !sysadmin_localhost_only)) {
    request.setSecurityContext(new SysAdminRoleAuthenticator());
    if (logger.isTraceEnabled()) {
      logger.trace("System administrator access allowed");
      if (!password_match) {
        logger.trace("Allowed sysadmin password mismatch because accessing via localhost");
      }
    }
  }
}

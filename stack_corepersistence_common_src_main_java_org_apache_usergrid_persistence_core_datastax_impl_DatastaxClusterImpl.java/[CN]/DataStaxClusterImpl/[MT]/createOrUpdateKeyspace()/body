{
  clusterSession=getClusterSession();
  final String createApplicationKeyspace=String.format("CREATE KEYSPACE IF NOT EXISTS %s WITH replication = %s",CQLUtils.quote(cassandraFig.getApplicationKeyspace()),CQLUtils.getFormattedReplication(cassandraFig.getStrategy(),cassandraFig.getStrategyOptions()));
  final String updateApplicationKeyspace=String.format("ALTER KEYSPACE %s WITH replication = %s",CQLUtils.quote(cassandraFig.getApplicationKeyspace()),CQLUtils.getFormattedReplication(cassandraFig.getStrategy(),cassandraFig.getStrategyOptions()));
  clusterSession.execute(createApplicationKeyspace);
  clusterSession.executeAsync(updateApplicationKeyspace);
  logger.info("Created/Updated keyspace: {}",cassandraFig.getApplicationKeyspace());
  waitForSchemaAgreement();
}

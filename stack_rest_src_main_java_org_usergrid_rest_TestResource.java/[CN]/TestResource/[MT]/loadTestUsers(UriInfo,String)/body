{
  ApiResponse response=new ApiResponse(ui);
  response.setAction("loading users");
  Map<String,String> properties=emf.getServiceProperties();
  if (properties == null) {
    response.setError("Unable to retrieve system properties, database is probably down.");
    return new JSONWithPadding(response,callback);
  }
  if ("true".equalsIgnoreCase(properties.get("test.users.loaded"))) {
    response.setError("Test users were already loaded.");
    return new JSONWithPadding(response,callback);
  }
  emf.setServiceProperty("test.users.loaded","true");
  logger.info("Loading users");
  UUID nsId=emf.lookupApplication("test-app");
  if (nsId == null) {
    response.setError("No test-app application created.");
    return new JSONWithPadding(response,callback);
  }
  Object json=JsonUtils.loadFromUrl(getSampleDataUrl("userlist.json"));
  @SuppressWarnings("unchecked") List<Map<String,Object>> set=(List<Map<String,Object>>)json;
  ServiceManager sm=smf.getServiceManager(nsId);
  ServiceRequest request=sm.newRequest(ServiceAction.POST,parameters("users"),batchPayload(set));
  request.execute();
  response.setSuccess();
  logger.info("Users loaded");
  return new JSONWithPadding(response,callback);
}

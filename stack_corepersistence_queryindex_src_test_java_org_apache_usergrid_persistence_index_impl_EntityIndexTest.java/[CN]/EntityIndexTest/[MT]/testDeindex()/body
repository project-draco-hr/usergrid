{
  Id appId=new SimpleId("application");
  IndexScope indexScope=new IndexScopeImpl(appId,appId,"fastcars");
  EntityIndex entityIndex=cif.createEntityIndex(indexScope);
  Map entityMap=new HashMap(){
{
      put("name","Ferrari 212 Inter");
      put("introduced",1952);
      put("topspeed",215);
    }
  }
;
  Entity entity=EntityIndexMapUtils.fromMap(entityMap);
  EntityUtils.setId(entity,new SimpleId("fastcar"));
  EntityUtils.setVersion(entity,UUIDGenerator.newTimeUUID());
  entityIndex.createBatch().index(indexScope,entity).executeAndRefresh();
  CandidateResults candidateResults=entityIndex.search(indexScope,Query.fromQL("name contains 'Ferrari*'"));
  assertEquals(1,candidateResults.size());
  entityIndex.createBatch().deindex(indexScope,entity).execute();
  entityIndex.refresh();
  candidateResults=entityIndex.search(indexScope,Query.fromQL("name contains 'Ferrari*'"));
  assertEquals(0,candidateResults.size());
}

{
  Id appId=new SimpleId("application");
  ApplicationScope applicationScope=new ApplicationScopeImpl(appId);
  ApplicationEntityIndex entityIndex=eif.createApplicationEntityIndex(applicationScope);
  final String entityType="thing";
  IndexEdge indexEdge=new IndexEdgeImpl(appId,"things",SearchEdge.NodeType.SOURCE,1);
  final SearchTypes searchTypes=SearchTypes.fromTypes(entityType);
  EntityIndexBatch batch=entityIndex.createBatch();
  Entity entity=new Entity(entityType);
  EntityUtils.setVersion(entity,UUIDGenerator.newTimeUUID());
  entity.setField(new UUIDField(IndexingUtils.ENTITY_ID_FIELDNAME,UUID.randomUUID()));
  entity.setField(new StringField("testfield","test"));
  batch.index(indexEdge,entity);
  batch.execute().get();
  EntityUtils.setVersion(entity,UUIDGenerator.newTimeUUID());
  List<String> list=new ArrayList<>();
  list.add("test");
  entity.setField(new ArrayField<String>("testfield",list));
  batch.index(indexEdge,entity);
  batch.execute().get();
  EntityUtils.setVersion(entity,UUIDGenerator.newTimeUUID());
  EntityObject testObj=new EntityObject();
  testObj.setField(new StringField("test","testFiedl"));
  entity.setField(new EntityObjectField("testfield",testObj));
  batch.index(indexEdge,entity);
  batch.execute().get();
  ei.refresh();
  testQueries(indexEdge,searchTypes,entityIndex);
}

{
  Subject currentUser=SubjectUtils.getSubject();
  if (currentUser == null) {
    return;
  }
  String permission=getPermissionFromPath(em.getApplicationRef().getUuid(),context.getAction().toString().toLowerCase(),path);
  boolean permitted=currentUser.isPermitted(permission);
  if (logger.isDebugEnabled()) {
    logger.debug(PATH_MSG,new Object[]{path,context.getAction(),permission,permitted});
  }
  SubjectUtils.checkPermission(permission);
}

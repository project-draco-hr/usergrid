{
  if (!traceTagManager.getTraceEnabled() && !traceTagManager.getExplicitOnly()) {
    return request;
  }
  String traceId;
  if (traceTagManager.getExplicitOnly()) {
    String id=httpServletRequest.getHeader("XX-TRACE-ID");
    if (StringUtils.isBlank(id)) {
      return request;
    }
    traceId=id.concat("-REST-").concat(request.getPath(true));
  }
 else {
    traceId="TRACE-".concat(request.getPath(true));
  }
  TraceTag traceTag=traceTagManager.create(traceId);
  traceTagManager.attach(traceTag);
  return request;
}

{
  EntityManagerFactory.ProgressObserver po=new EntityManagerFactory.ProgressObserver(){
    @Override public void onProgress(    final EntityRef entity){
      logger.info("Indexing entity {}:{}",entity.getType(),entity.getUuid());
    }
    @Override public long getWriteDelayTime(){
      return delay;
    }
  }
;
  logger.info("Reindexing for app id: {} and collection {}",applicationId,collectionName);
  emf.rebuildCollectionIndex(applicationId,collectionName,reverse,po);
  emf.refreshIndex();
}

{
  EntityCollectionManager ecm=getManager(systemScope);
  EntityCollectionIndex eci=getIndex(systemScope);
  String orgName=(app == null) ? SYSTEM_ORG_TYPE : app.getOrganizationName();
  org.apache.usergrid.persistence.index.query.Query q=org.apache.usergrid.persistence.index.query.Query.fromQL("name = '" + orgName + "'");
  org.apache.usergrid.persistence.index.query.Results execute=eci.execute(q);
  if (execute.isEmpty()) {
    org.apache.usergrid.persistence.model.entity.Entity entity=new org.apache.usergrid.persistence.model.entity.Entity(new SimpleId(UUIDGenerator.newTimeUUID(),"organization"));
    entity.setField(new StringField("name",orgName));
    entity=ecm.write(entity).toBlockingObservable().last();
    Id orgId=entity.getId();
    return orgId;
  }
  org.apache.usergrid.persistence.model.entity.Entity entity=execute.getEntities().get(0);
  Id orgId=entity.getId();
  return orgId;
}

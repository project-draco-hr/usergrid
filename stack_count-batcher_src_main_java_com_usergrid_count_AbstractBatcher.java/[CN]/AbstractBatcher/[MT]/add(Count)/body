{
  invocationCounter.inc();
  final TimerContext context=addTimer.time();
  batch.add(count);
  if (shouldSubmit(batch) && submitLock.tryLock()) {
    try {
      submit(copyAndClear(batch));
    }
  finally {
      submitLock.unlock();
    }
  }
  context.stop();
}

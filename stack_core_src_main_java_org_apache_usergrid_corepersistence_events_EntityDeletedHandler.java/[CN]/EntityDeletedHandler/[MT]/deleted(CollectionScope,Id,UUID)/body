{
  if (System.getProperty(EVENTS_DISABLED,"false").equals("true")) {
    return;
  }
  logger.debug("Handling deleted event for entity {}:{} v {} " + "scope\n   name: {}\n   owner: {}\n   app: {}",new Object[]{entityId.getType(),entityId.getUuid(),version,scope.getName(),scope.getOwner(),scope.getApplication()});
  CpEntityManagerFactory cpemf=(CpEntityManagerFactory)emf;
  final EntityIndex ei=cpemf.getManagerCache().getEntityIndex(scope);
  final IndexScope indexScope=new IndexScopeImpl(new SimpleId(scope.getOwner().getUuid(),scope.getOwner().getType()),scope.getName());
  ei.createBatch().deindex(indexScope,entityId,version).execute();
}

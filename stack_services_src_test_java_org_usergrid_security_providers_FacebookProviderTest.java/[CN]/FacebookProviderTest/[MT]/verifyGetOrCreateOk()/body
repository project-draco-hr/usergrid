{
  Application application=emf.getEntityManager(applicationId).getApplication();
  Map fb_user=MapUtils.hashMap("id","12345678").map("name","Facebook User").map("username","fb.user");
  FacebookProvider facebookProvider=(FacebookProvider)providerFactory.facebook(application);
  facebookProvider=Mockito.spy(facebookProvider);
  Mockito.when(facebookProvider.userFromResource(Mockito.anyString())).thenReturn(fb_user);
  User user1=facebookProvider.createOrAuthenticate(fb_access_token);
  assertNotNull(user1);
}

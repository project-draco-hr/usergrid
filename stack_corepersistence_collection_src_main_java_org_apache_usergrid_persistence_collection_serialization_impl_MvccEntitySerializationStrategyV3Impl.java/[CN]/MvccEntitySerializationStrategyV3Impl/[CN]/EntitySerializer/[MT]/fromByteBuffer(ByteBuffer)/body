{
  EntityWrapper entityWrapper;
  try {
    entityWrapper=MAPPER.readValue(byteBuffer.array(),EntityWrapper.class);
    if (VERSION != entityWrapper.getSerailizationVersion()) {
      throw new UnsupportedOperationException("A version of type " + entityWrapper.getSerailizationVersion() + " is unsupported");
    }
    if (entityWrapper.getEntity() == null) {
      return new EntityWrapper(MvccEntity.Status.DELETED,entityWrapper.getVersion(),null,VERSION);
    }
  }
 catch (  Exception e) {
    if (log.isDebugEnabled()) {
      log.debug("Entity Wrapper Deserialized: " + StringSerializer.get().fromByteBuffer(byteBuffer));
    }
    throw new DataCorruptionException("Unable to read entity data",e);
  }
  return entityWrapper;
}

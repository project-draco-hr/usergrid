{
  EntityWrapper entityWrapper;
  try {
    entityWrapper=MAPPER.readValue(byteBuffer.array(),EntityWrapper.class);
    if (VERSION != entityWrapper.getSerailizationVersion()) {
      throw new UnsupportedOperationException("A version of type " + entityWrapper.getSerailizationVersion() + " is unsupported");
    }
  }
 catch (  Exception e) {
    if (log.isDebugEnabled()) {
      log.debug("Entity Wrapper Deserialized: " + StringSerializer.get().fromByteBuffer(byteBuffer));
    }
    throw new DataCorruptionException("Unable to read entity data",e);
  }
  if (entityWrapper.getEntityMap() == null) {
    return new EntityWrapper(entityWrapper.getId(),entityWrapper.getVersion(),MvccEntity.Status.DELETED,VERSION,null);
  }
  entityWrapper.setStatus(MvccEntity.Status.COMPLETE);
  return entityWrapper;
}

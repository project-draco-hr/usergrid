{
  log.info("Entering after");
synchronized (mutex) {
    if (clientCount.decrementAndGet() < 1) {
      log.info("----------------------------------------------------------------------");
      log.info("Destroying Tomcat running on port " + port);
      log.info("----------------------------------------------------------------------");
      if (process != null) {
        process.destroy();
      }
 else       if (tomcat != null) {
        try {
          tomcat.stop();
          tomcat.destroy();
        }
 catch (        LifecycleException ex) {
          log.error("Error stopping Tomcat",ex);
        }
      }
      started=false;
    }
 else {
      log.info("NOT stopping Tomcat because it is still in use by {}",clientCount.get());
    }
  }
  log.info("Leaving after");
}

{
  try {
    if (isBlank(email)) {
      errorMsg="No email provided, try again...";
      throw new Exception("No email provided");
    }
 else     if (useReCaptcha()) {
      ReCaptchaImpl reCaptcha=new ReCaptchaImpl();
      reCaptcha.setPrivateKey(properties.getRecaptchaPrivate());
      ReCaptchaResponse reCaptchaResponse=reCaptcha.checkAnswer(httpServletRequest.getRemoteAddr(),challenge,uresponse);
      if (!reCaptchaResponse.isValid()) {
        errorMsg="Incorrect Captcha, try again...";
        throw new Exception("reCAPTCHA error message: " + reCaptchaResponse.getErrorMessage());
      }
    }
    user=management.getAppUserByIdentifier(getApplicationId(),Identifier.fromEmail(email));
    if (user == null) {
      errorMsg="We don't recognize that email, try again...";
      throw new Exception("Unrecognized email address " + email);
    }
    logger.info(String.format("Starting AppUser Password Reset Flow for %s on %s",user.getUuid(),getApplicationId()));
    management.startAppUserPasswordResetFlow(getApplicationId(),user);
    return handleViewable("resetpw_email_success",this);
  }
 catch (  RedirectionException e) {
    throw e;
  }
catch (  Exception e) {
    logger.error(String.format("Exception in password reset form. (%s) %s ",e.getClass().getCanonicalName(),e.getMessage()));
    return handleViewable("resetpw_email_form",this);
  }
}

{
  File applicationFile=new File(importDir,applicationName);
  logger.info("Loading application file: " + applicationFile.getAbsolutePath());
  JsonParser jp=getJsonParserForFile(applicationFile);
  JsonToken token=jp.nextToken();
  validateStartArray(token);
  token=jp.nextValue();
  Application application=jp.readValueAs(Application.class);
  @SuppressWarnings("unchecked") String organizationId=((Map<String,String>)application.getMetadata("organization")).get("key");
  managementService.importApplication(UUID.fromString(organizationId),application);
  echo(application);
  EntityManager em=emf.getEntityManager(application.getUuid());
  while (jp.nextValue() != JsonToken.END_ARRAY) {
    @SuppressWarnings("unchecked") Map<String,Object> entityProps=jp.readValueAs(HashMap.class);
    UUID uuid=getId(entityProps);
    String type=getType(entityProps);
    try {
      em.create(uuid,type,entityProps);
    }
 catch (    Exception e) {
      logger.error("Unable to create entity " + uuid + " of type "+ type+ ", skipping but this may indicate a bad import...",e);
    }
    echo(entityProps);
  }
  logger.info("----- End of application:" + application.getName());
  jp.close();
}

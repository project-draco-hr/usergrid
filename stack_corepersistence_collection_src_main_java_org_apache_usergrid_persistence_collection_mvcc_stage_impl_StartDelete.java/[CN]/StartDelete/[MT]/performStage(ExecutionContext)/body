{
  final UUID entityId=executionContext.getMessage(UUID.class);
  final UUID version=uuidService.newTimeUUID();
  Preconditions.checkNotNull(entityId,"Entity id is required in this stage");
  Preconditions.checkNotNull(version,"Entity version is required in this stage");
  final CollectionContext collectionContext=executionContext.getCollectionContext();
  final MvccLogEntry startEntry=new MvccLogEntryImpl(entityId,version,org.apache.usergrid.persistence.collection.mvcc.entity.Stage.ACTIVE);
  MutationBatch write=logStrategy.write(collectionContext,startEntry);
  try {
    write.execute();
  }
 catch (  ConnectionException e) {
    LOG.error("Failed to execute write asynchronously ",e);
    throw new CollectionRuntimeException("Failed to execute write asynchronously ",e);
  }
  final MvccEntityImpl nextStage=new MvccEntityImpl(entityId,version,Optional.<Entity>absent());
  executionContext.setMessage(nextStage);
  executionContext.proceed();
}

{
  final Id candidateId=candidateResult.getId();
  final UUID candidateVersion=candidateResult.getVersion();
  final MvccEntity entity=entitySet.getEntity(candidateId);
  if (entity == null) {
    logger.warn("Searched and received candidate with entityId {} and version {}, yet was not found in cassandra." + "  Ignoring since this could be a region sync issue",candidateId,candidateVersion);
    return;
  }
  final UUID entityVersion=entity.getVersion();
  if (UUIDComparator.staticCompare(entityVersion,candidateVersion) > 0) {
    final Id entityId=entity.getId();
    final SearchEdge searchEdge=candidateResults.getSearchEdge();
    logger.warn("Deindexing stale entity on edge {} for entityId {} and version {}",new Object[]{searchEdge,entityId,entityVersion});
    batch.deindex(searchEdge,entityId,entityVersion);
    return;
  }
  if (UUIDComparator.staticCompare(candidateVersion,entityVersion) > 0) {
    final Id entityId=entity.getId();
    final SearchEdge searchEdge=candidateResults.getSearchEdge();
    logger.warn("Found a newer version in ES over cassandra for edge {} for entityId {} and version {}.  Repair " + "should be run",new Object[]{searchEdge,entityId,entityVersion});
    return;
  }
  results.add(entity.getEntity().get());
}

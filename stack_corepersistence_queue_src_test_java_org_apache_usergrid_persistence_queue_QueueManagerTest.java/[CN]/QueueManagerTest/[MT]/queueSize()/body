{
  HashMap<String,String> values=new HashMap<>();
  values.put("test","Test");
  List<Map<String,String>> bodies=new ArrayList<>();
  bodies.add(values);
  long initialDepth=qm.getQueueDepth();
  qm.sendMessages(bodies);
  long depth=qm.getQueueDepth();
  assertTrue(depth > 0);
  List<QueueMessage> messageList=qm.getMessages(10,5000,5000,values.getClass()).toList().toBlocking().last();
  assertTrue(messageList.size() <= 500);
  for (  QueueMessage message : messageList) {
    assertTrue(message.getBody().equals(values));
  }
  if (messageList.size() > 0) {
    qm.commitMessages(messageList);
  }
  depth=qm.getQueueDepth();
  assertEquals(initialDepth,depth);
}

{
  Preconditions.checkNotNull(message,"Message cannot be null");
  indexSizeCounter.inc(message.getOperations().size());
  Timer.Context time=timer.time();
  messages.offer(message);
  time.stop();
  return message.getFuture();
}

{
  int failCount=Integer.parseInt(props.getProperty(FAIL_PROP));
  FailureJobExceuction job=CassandraRunner.getBean("failureJobExceuction",FailureJobExceuction.class);
  job.setLatch(failCount + 1);
  JobData returned=scheduler.createJob("failureJobExceuction",System.currentTimeMillis(),new JobData());
  boolean waited=job.waitForCount(60,TimeUnit.SECONDS);
  assertTrue("Job ran to failure",waited);
  JobStat stat=scheduler.getStatsForJob(returned.getJobName(),returned.getUuid());
  assertEquals(failCount + 1,stat.getTotalAttempts());
  assertEquals(failCount + 1,stat.getRunCount());
  assertEquals(0,stat.getDelayCount());
}

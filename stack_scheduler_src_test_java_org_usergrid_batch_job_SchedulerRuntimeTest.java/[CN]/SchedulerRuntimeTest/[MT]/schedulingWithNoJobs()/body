{
  int count=200;
  CountdownLatchJob counterJob=CassandraRunner.getBean(CountdownLatchJob.class);
  counterJob.setLatch(count);
  for (int i=0; i < count; i++) {
    scheduler.createJob("countdownLatch",System.currentTimeMillis(),new JobData());
  }
  boolean waited=counterJob.waitForCount(30000,TimeUnit.SECONDS);
  assertTrue("Jobs ran",waited);
  Thread.sleep(5000);
  counterJob.setLatch(count);
  for (int i=0; i < count; i++) {
    scheduler.createJob("countdownLatch",System.currentTimeMillis(),new JobData());
  }
  waited=counterJob.waitForCount(3000000,TimeUnit.SECONDS);
  assertTrue("Jobs ran",waited);
}

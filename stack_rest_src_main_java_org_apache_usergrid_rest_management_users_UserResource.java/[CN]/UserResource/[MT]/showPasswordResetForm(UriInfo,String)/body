{
  final boolean externalTokensEnabled=!StringUtils.isEmpty(properties.getProperty(ManagementResource.USERGRID_CENTRAL_URL));
  if (externalTokensEnabled) {
    throw new IllegalArgumentException("Admin Users must reset passwords via " + properties.getProperty(ManagementResource.USERGRID_CENTRAL_URL));
  }
  try {
    this.token=token;
    if (management.checkPasswordResetTokenForAdminUser(user.getUuid(),token)) {
      return handleViewable("resetpw_set_form",this);
    }
 else {
      return handleViewable("resetpw_email_form",this);
    }
  }
 catch (  RedirectionException e) {
    throw e;
  }
catch (  Exception e) {
    return handleViewable("error",e);
  }
}

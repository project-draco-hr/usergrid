{
  if (tokens.isExternalSSOProviderEnabled()) {
    throw new IllegalArgumentException("Admin Users must reset passwords via " + properties.getProperty(USERGRID_EXTERNAL_SSO_PROVIDER_URL));
  }
  if (json == null) {
    return null;
  }
  String oldPassword=string(json.get("oldpassword"));
  String newPassword=string(json.get("newpassword"));
  if (isServiceAdmin()) {
    management.setAdminUserPassword(user.getUuid(),newPassword);
  }
 else {
    management.setAdminUserPassword(user.getUuid(),oldPassword,newPassword);
  }
  ApiResponse response=createApiResponse();
  response.setAction("set user password");
  return response;
}

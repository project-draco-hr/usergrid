{
  Queue queue=context.application().queues().queue("test");
  final int count=30;
  for (int i=0; i < count; i++) {
    queue.post(MapUtils.hashMap("name","todd").map("id",String.valueOf(i)).map("indexed","true"));
  }
  queue=queue.withLimit(1).withPosition(QueuePosition.END.name()).withFilters("name = 'todd'","id >= 20","id <= 30").withLast(null);
  ReverseMatchHandler handler=new ReverseMatchHandler(30,10);
  testMessages(queue,handler);
  handler.assertResults();
  handler=new ReverseMatchHandler(10,10);
  testMessages(queue,handler);
  handler.assertResults();
}

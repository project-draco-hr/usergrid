{
  EntityManager em=app.getEntityManager();
  EntityIndexFactory eif=SpringResource.getInstance().getBean(Injector.class).getInstance(EntityIndexFactory.class);
  ApplicationScope as=new ApplicationScopeImpl(new SimpleId(em.getApplicationId(),TYPE_APPLICATION));
  ApplicationEntityIndex ei=eif.createApplicationEntityIndex(as);
  final Id rootId=createId(em.getApplicationId(),TYPE_APPLICATION);
  SearchEdge is=CpNamingUtils.createCollectionSearchEdge(rootId,collName);
  return ei.search(is,SearchTypes.fromTypes(type),query,10000);
}

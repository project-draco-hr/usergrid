{
  final int setSize=65535 * 2;
  final Entity entity=EntityHelper.generateEntity(setSize);
  CollectionScope context=new CollectionScopeImpl(new SimpleId("organization"),new SimpleId("test"),"test");
  final Id simpleId=new SimpleId("test");
  final UUID version=UUIDGenerator.newTimeUUID();
  final MvccEntity.Status status=MvccEntity.Status.COMPLETE;
  final MvccEntity mvccEntity=new MvccEntityImpl(simpleId,version,status,entity);
  getMvccEntitySerializationStrategy().write(context,mvccEntity).execute();
  final Iterator<MvccEntity> loaded=getMvccEntitySerializationStrategy().loadHistory(context,entity.getId(),version,100);
  assertTrue(loaded.hasNext());
  final MvccEntity loadedEntity=loaded.next();
  assertEquals("The loaded entity should match the stored entity",mvccEntity,loadedEntity);
  EntityHelper.verifySame(entity,loadedEntity.getEntity().get());
}

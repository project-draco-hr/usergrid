{
  HybridEntityManagerFactory hemf=(HybridEntityManagerFactory)CpSetup.getEntityManagerFactory();
  CpEntityManagerFactory cpemf=(CpEntityManagerFactory)hemf.getImplementation();
  final EntityIndex ei=cpemf.getManagerCache().getEntityIndex(scope);
  final EntityIndexBatch eibatch=ei.createBatch();
  final IndexScope indexScope=new IndexScopeImpl(new SimpleId(scope.getOwner().getUuid(),scope.getOwner().getType()),scope.getName());
  rx.Observable.from(entityVersions).subscribeOn(Schedulers.io()).buffer(serializationFig.getBufferSize()).map(new Func1<List<MvccEntity>,List<MvccEntity>>(){
    @Override public List<MvccEntity> call(    List<MvccEntity> entityList){
      for (      MvccEntity entity : entityList) {
        eibatch.deindex(indexScope,entityId,entity.getVersion());
      }
      eibatch.execute();
      return entityList;
    }
  }
).toBlocking().last();
}

{
  if (username == null || grant_type == null || !grant_type.equalsIgnoreCase("password")) {
    return;
  }
  final boolean externalTokensEnabled=!StringUtils.isEmpty(properties.getProperty(USERGRID_CENTRAL_URL));
  if (externalTokensEnabled) {
    final String superuserName=properties.getProperty(USERGRID_SYSADMIN_LOGIN_NAME);
    if (!username.equalsIgnoreCase(superuserName)) {
      throw new IllegalArgumentException("Admin Users must login via " + properties.getProperty(USERGRID_CENTRAL_URL));
    }
  }
}

{
  if (username == null || grant_type == null || !grant_type.equalsIgnoreCase("password")) {
    return;
  }
  if (tokens.isExternalSSOProviderEnabled()) {
    if (!userServiceAdmin(username)) {
      throw new IllegalArgumentException("Admin Users must login via " + properties.getProperty(USERGRID_EXTERNAL_SSO_PROVIDER_URL));
    }
  }
}

{
  final boolean externalTokensEnabled=!StringUtils.isEmpty(properties.getProperty(USERGRID_CENTRAL_URL));
  if (externalTokensEnabled) {
    final String superuserName=properties.getProperty(USERGRID_SYSADMIN_LOGIN_NAME);
    final String superuserAllowedStr=properties.getProperty(USERGRID_SYSADMIN_LOGIN_ALLOWED);
    final boolean superuserAllowed=!StringUtils.isEmpty(superuserAllowedStr) && superuserAllowedStr.trim().equalsIgnoreCase("true");
    if (superuserAllowed && !superuserName.equalsIgnoreCase(username)) {
      throw new IllegalArgumentException("Admin Users must login via " + properties.getProperty(USERGRID_CENTRAL_URL));
    }
  }
}

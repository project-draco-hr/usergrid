{
  ServiceManager sm=smf.getServiceManager(applicationId);
  assertNotNull(sm);
  EntityManager em=sm.getEntityManager();
  assertNotNull(em);
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("name",roleName);
  props.put("title",roleTitle);
  props.put("inactivity",inactivity);
  ServiceResults results=testRequest(sm,action,1,props,"roles");
  Entity roleEntity=results.getEntities().get(0);
  assertEquals(roleName,roleEntity.getProperty("name"));
  assertEquals(roleTitle,roleEntity.getProperty("title"));
  assertEquals(inactivity,roleEntity.getProperty("inactivity"));
  Map<String,Role> roles=em.getRolesWithTitles(Collections.singleton(roleName));
  Role role=roles.get(roleName);
  assertNotNull(role);
  assertEquals(roleName,role.getName());
  assertEquals(roleTitle,role.getTitle());
  assertEquals(inactivity,role.getInactivity().longValue());
}

{
  final String name=(String)oldAppInfo.get(PROPERTY_NAME);
  final String orgName=name.split("/")[0];
  final String appName=name.split("/")[1];
  UUID applicationId;
  Object uuidObject=oldAppInfo.get("applicationUuid");
  if (uuidObject instanceof UUID) {
    applicationId=(UUID)uuidObject;
  }
 else {
    applicationId=UUIDUtils.tryExtractUUID(uuidObject.toString());
  }
  final UUID appId=applicationId;
  Entity appInfo=getApplicationInfo(emf,appId);
  if (appInfo == null) {
    Map<String,Object> appInfoMap=new HashMap<String,Object>(){
{
        put(PROPERTY_NAME,name);
        put(PROPERTY_APPLICATION_ID,appId);
      }
    }
;
    appInfo=em.create(appId,CpNamingUtils.APPLICATION_INFO,appInfoMap);
    observer.update(getMaxVersion(),"Created application_info for " + appName);
  }
 else {
    appInfo.setProperty(PROPERTY_APPLICATION_ID,appId);
    em.update(appInfo);
    observer.update(getMaxVersion(),"Updated existing application_info for " + appName);
  }
  if (!orgName.equals("usergrid")) {
    EntityRef orgRef=em.getAlias(Group.ENTITY_TYPE,orgName);
    em.createConnection(orgRef,"owns",appInfo);
  }
}

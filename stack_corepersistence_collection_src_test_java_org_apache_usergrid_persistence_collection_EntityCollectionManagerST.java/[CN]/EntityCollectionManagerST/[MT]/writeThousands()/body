{
  CollectionScope context=new CollectionScopeImpl(new SimpleId("organization"),new SimpleId("test"),"test");
  EntityCollectionManager manager=factory.createCollectionManager(context);
  int limit=10000;
  StopWatch timer=new StopWatch();
  timer.start();
  for (int i=0; i < limit; i++) {
    Entity newEntity=new Entity(new SimpleId("test"));
    Observable<Entity> observable=manager.write(newEntity);
    Entity returned=observable.toBlockingObservable().lastOrDefault(null);
    assertNotNull("Returned has a id",returned.getId());
    assertNotNull("Returned has a version",returned.getVersion());
    Entity fetched=manager.load(returned.getId()).toBlockingObservable().last();
    assertNotNull("Returned has a id",fetched.getId());
    assertNotNull("Returned has a version",fetched.getVersion());
    if (i % 1000 == 0) {
      log.info("   Wrote: " + i);
    }
  }
  timer.stop();
  log.info("Total time to write {} entries {}ms, average {}ms/entry",limit,timer.getTime(),timer.getTime() / limit);
}

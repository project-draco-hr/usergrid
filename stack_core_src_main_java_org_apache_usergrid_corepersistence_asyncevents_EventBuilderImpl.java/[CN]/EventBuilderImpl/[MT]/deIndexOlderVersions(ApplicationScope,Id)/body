{
  if (logger.isDebugEnabled()) {
    logger.debug("Removing old versions of entity {} from index in app scope {}",entityId,applicationScope);
  }
  final EntityCollectionManager ecm=entityCollectionManagerFactory.createCollectionManager(applicationScope);
  VersionSet latestVersions=ecm.getLatestVersion(Collections.singletonList(entityId)).toBlocking().firstOrDefault(null);
  Observable<IndexOperationMessage> deIndexObservable=Observable.empty();
  if (latestVersions.getMaxVersion(entityId) != null) {
    UUID latestVersion=latestVersions.getMaxVersion(entityId).getVersion();
    deIndexObservable=indexService.deleteEntityIndexes(applicationScope,entityId,latestVersion);
  }
  return deIndexObservable;
}

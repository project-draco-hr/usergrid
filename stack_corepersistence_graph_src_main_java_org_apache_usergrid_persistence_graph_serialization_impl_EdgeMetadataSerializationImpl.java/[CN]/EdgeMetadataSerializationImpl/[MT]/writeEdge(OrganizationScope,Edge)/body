{
  ValidationUtils.validateOrganizationScope(scope);
  EdgeUtils.validateEdge(edge);
  MutationBatch batch=keyspace.prepareMutationBatch();
  final Id source=edge.getSourceNode();
  final Id target=edge.getTargetNode();
  final String edgeType=edge.getType();
  final long timestamp=edge.getVersion().timestamp();
  final ScopedRowKey<OrganizationScope,Id> sourceKey=new ScopedRowKey<OrganizationScope,Id>(scope,source);
  batch.withRow(CF_TARGET_EDGE_TYPES,sourceKey).setTimestamp(timestamp).putColumn(edgeType,HOLDER);
  final ScopedRowKey<OrganizationScope,EdgeIdTypeKey> sourceTypeKey=new ScopedRowKey<OrganizationScope,EdgeIdTypeKey>(scope,new EdgeIdTypeKey(source,edgeType));
  batch.withRow(CF_TARGET_EDGE_ID_TYPES,sourceTypeKey).setTimestamp(timestamp).putColumn(target.getType(),HOLDER);
  final ScopedRowKey<OrganizationScope,Id> targetKey=new ScopedRowKey<OrganizationScope,Id>(scope,target);
  batch.withRow(CF_SOURCE_EDGE_TYPES,targetKey).setTimestamp(timestamp).putColumn(edgeType,HOLDER);
  final ScopedRowKey<OrganizationScope,EdgeIdTypeKey> targetTypeKey=new ScopedRowKey<OrganizationScope,EdgeIdTypeKey>(scope,new EdgeIdTypeKey(target,edgeType));
  batch.withRow(CF_SOURCE_EDGE_ID_TYPES,targetTypeKey).setTimestamp(timestamp).putColumn(source.getType(),HOLDER);
  return batch;
}

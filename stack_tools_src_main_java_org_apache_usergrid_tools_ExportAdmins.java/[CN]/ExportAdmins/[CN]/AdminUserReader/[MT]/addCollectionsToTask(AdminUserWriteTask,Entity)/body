{
  EntityManager em=emf.getEntityManager(CassandraService.MANAGEMENT_APPLICATION_ID);
  Set<String> collections=em.getCollections(entity);
  if ((collections == null) || collections.isEmpty()) {
    return;
  }
  task.collectionsByName=new HashMap<String,List<UUID>>();
  for (  String collectionName : collections) {
    List<UUID> uuids=task.collectionsByName.get(collectionName);
    if (uuids == null) {
      uuids=new ArrayList<UUID>();
      task.collectionsByName.put(collectionName,uuids);
    }
    Results collectionMembers=em.getCollection(entity,collectionName,null,100000,Level.IDS,false);
    List<UUID> entityIds=collectionMembers.getIds();
    if ((entityIds != null) && !entityIds.isEmpty()) {
      for (      UUID childEntityUUID : entityIds) {
        uuids.add(childEntityUUID);
      }
    }
  }
}

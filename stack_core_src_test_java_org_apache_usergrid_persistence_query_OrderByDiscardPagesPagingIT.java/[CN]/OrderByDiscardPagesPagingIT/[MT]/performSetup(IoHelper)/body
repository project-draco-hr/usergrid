{
  io.doSetup();
  int size=(int)(QueryProcessor.PAGE_SIZE * 2.5);
  long start=System.currentTimeMillis();
  LOG.info("Writing {} entities.",size);
  Set<UUID> entites=new HashSet<UUID>(size);
  for (int i=0; i < size; i++) {
    Map<String,Object> entity=new HashMap<String,Object>();
    entity.put("ordinal",i);
    int segment=i / PAGE_SIZE;
    boolean shouldBeReturned=segment % 2 != 0;
    if (shouldBeReturned) {
      entity.put("field1",true);
      entity.put("field2",true);
    }
 else {
      entity.put("field1",false);
      entity.put("field2",false);
    }
    Entity saved=io.writeEntity(entity);
    LOG.info("Writing entity with id '{}'",saved.getUuid());
    if (shouldBeReturned) {
      entites.add(saved.getUuid());
    }
  }
  long stop=System.currentTimeMillis();
  LOG.info("Writes took {} ms",stop - start);
  return entites;
}

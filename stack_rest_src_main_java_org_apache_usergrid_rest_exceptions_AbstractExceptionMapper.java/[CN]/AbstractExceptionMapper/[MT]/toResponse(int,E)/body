{
  if (status >= 500) {
    logger.error(e.getClass().getCanonicalName() + " Server Error (" + status+ ")",e);
  }
 else   if (logger.isDebugEnabled()) {
    logger.debug(e.getClass().getCanonicalName() + " Server Error (" + status+ ")",e);
  }
  ApiResponse response=new ApiResponse();
  logger.error("Uncaught Exception",e);
  AuthErrorInfo authError=AuthErrorInfo.getForException(e);
  if (authError != null) {
    response.setError(authError.getType(),authError.getMessage(),e);
  }
 else {
    response.setError(e);
  }
  String jsonResponse=mapToJsonString(response);
  return toResponse(status,jsonResponse);
}

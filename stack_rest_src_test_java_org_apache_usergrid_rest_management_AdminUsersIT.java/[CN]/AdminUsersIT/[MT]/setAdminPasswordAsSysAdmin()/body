{
  String username=clientSetup.getUsername();
  String password=clientSetup.getPassword();
  Map<String,Object> passwordPayload=new HashMap<String,Object>();
  passwordPayload.put("newpassword","testPassword");
  management.users().user(username).password().post(clientSetup.getSuperuserToken(),passwordPayload);
  this.refreshIndex();
  assertNotNull(management.token().post(Token.class,new Token(username,"testPassword")));
  try {
    management.token().post(Token.class,new Token(username,password));
    fail("We shouldn't be able to get a token using the old password");
  }
 catch (  UniformInterfaceException uie) {
    errorParse(400,"invalid_grant",uie);
  }
}

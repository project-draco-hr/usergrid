{
  Map<String,String> originalProperties=getRemoteTestProperties();
  try {
    setTestProperty(PROPERTIES_SYSADMIN_APPROVES_ADMIN_USERS,"false");
    setTestProperty(PROPERTIES_SYSADMIN_APPROVES_ORGANIZATIONS,"false");
    setTestProperty(PROPERTIES_ADMIN_USERS_REQUIRE_CONFIRMATION,"true");
    assertTrue(setup.getMgmtSvc().newAdminUsersRequireConfirmation());
    assertFalse(setup.getMgmtSvc().newAdminUsersNeedSysAdminApproval());
    String sysadminUsername=(String)setup.getMgmtSvc().getProperties().get(AccountCreationProps.PROPERTIES_SYSADMIN_LOGIN_EMAIL);
    String sysadminPassword=(String)setup.getMgmtSvc().getProperties().get(AccountCreationProps.PROPERTIES_SYSADMIN_LOGIN_PASSWORD);
    JsonNode node;
    try {
      node=resource().path("/management/token").queryParam("grant_type","password").queryParam("username",sysadminUsername).queryParam("password",sysadminPassword).accept(MediaType.APPLICATION_JSON).get(JsonNode.class);
    }
 catch (    UniformInterfaceException e) {
      fail("Sysadmin should need no confirmation");
    }
  }
  finally {
    setTestProperties(originalProperties);
  }
}

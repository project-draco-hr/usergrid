{
  LOG.info("Creating CassandraResource using {} for the ClassLoader.",Thread.currentThread().getContextClassLoader());
  this.schemaManagerName=schemaManagerName;
  this.rpcPort=rpcPort;
  this.storagePort=storagePort;
  this.sslStoragePort=sslStoragePort;
  this.nativeTransportPort=nativeTransportPort;
  try {
    this.tempDir=getTempDirectory();
  }
 catch (  IOException e) {
    LOG.error("Failed to create temporary directory for Cassandra instance.",e);
    throw new RuntimeException(e);
  }
  try {
    String[] locations={"usergrid-properties-context.xml"};
    ConfigurableApplicationContext appContext=new ClassPathXmlApplicationContext(locations);
    Properties properties=(Properties)appContext.getBean("properties");
    properties.putAll(ArrayUtils.toMap(this.getProjectProperties().entrySet().toArray(new Object[]{})));
    String forkString=properties.getProperty("cassandra.startup");
    forkCassandra="forked".equals(forkString);
    externalCassandra="external".equals(forkString);
  }
 catch (  Exception ex) {
    throw new RuntimeException("Error getting properties",ex);
  }
}

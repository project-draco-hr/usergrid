{
  super.after();
  if (process != null) {
    process.destroy();
  }
 else {
    shutdown=new Thread(){
      @Override public void run(){
        try {
          Thread.currentThread();
          Thread.sleep(100L);
        }
 catch (        InterruptedException ignored) {
        }
        if (externalCassandra) {
          LOG.info("Cleaning up external Cassandra instance");
        }
 else {
          LOG.info("Shutting down Cassandra instance in {}",tempDir.toString());
        }
        if (schemaManager != null) {
          LOG.info("Destroying schemaManager...");
          try {
            schemaManager.destroy();
          }
 catch (          Exception e) {
            LOG.error("Ignoring failures while dropping keyspaces: {}",e.getMessage());
          }
          LOG.info("SchemaManager destroyed...");
        }
        applicationContext.stop();
        LOG.info("ApplicationContext stopped...");
        try {
          if (!externalCassandra && cassandraDaemon != null) {
            LOG.info("Deactivating CassandraDaemon...");
            cassandraDaemon.deactivate();
          }
        }
 catch (        Exception ex) {
          LOG.error("Error deactivating Cassandra",ex);
        }
      }
    }
;
    shutdown.start();
  }
}

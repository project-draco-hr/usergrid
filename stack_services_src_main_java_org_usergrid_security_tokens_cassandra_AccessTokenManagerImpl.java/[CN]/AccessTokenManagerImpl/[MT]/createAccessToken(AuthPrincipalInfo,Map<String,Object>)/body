{
  UUID uuid=UUIDUtils.newTimeUUID();
  long timestamp=getTimestampInMillis(uuid);
  AccessTokenInfo tokenInfo=new AccessTokenInfo(uuid,principal.getType().toString().toLowerCase(),timestamp,timestamp,principal,state);
  putAccessTokenInfo(tokenInfo);
  return getTokenForUUID(uuid);
}

{
  final EdgeRowKey key=new EdgeRowKey(nodeId,types);
  final ScopedRowKey rowKey=ScopedRowKey.fromKey(scope,key);
  try {
    OperationResult<Column<Long>> column=keyspace.prepareQuery(EDGE_SHARD_COUNTS).getKey(rowKey).getColumn(shardId).execute();
    return column.getResult().getLongValue();
  }
 catch (  ConnectionException e) {
    throw new CollectionRuntimeException("An error occurred connecting to cassandra",e);
  }
}

{
  long ttl=2000;
  QueryParameters queryParameters=new QueryParameters();
  queryParameters.addParam("grant_type","password");
  queryParameters.addParam("username",clientSetup.getUsername());
  queryParameters.addParam("password",clientSetup.getPassword());
  queryParameters.addParam("ttl",String.valueOf(ttl));
  Token adminToken=management().token().get(queryParameters);
  long startTime=System.currentTimeMillis();
  Entity user=management().users().user(clientSetup.getUsername()).get();
  assertEquals(clientSetup.getUsername(),user.get("username"));
  Thread.sleep(ttl - (System.currentTimeMillis() - startTime) + 1000);
  ClientResponse.Status responseStatus=null;
  try {
    management().users().user(clientSetup.getUsername()).get();
  }
 catch (  UniformInterfaceException uie) {
    responseStatus=uie.getResponse().getClientResponseStatus();
  }
  assertEquals(ClientResponse.Status.UNAUTHORIZED,responseStatus);
}

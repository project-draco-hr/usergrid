{
  if (msg instanceof UniqueValueActor.Reservation) {
    UniqueValueActor.Reservation res=(UniqueValueActor.Reservation)msg;
    ReservationCache.getInstance().cacheReservation(res);
    if (++reservationCount % 10 == 0) {
      logger.info("Received {} reservations cache size {}",reservationCount,ReservationCache.getInstance().getSize());
    }
  }
 else   if (msg instanceof UniqueValueActor.Cancellation) {
    UniqueValueActor.Cancellation can=(UniqueValueActor.Cancellation)msg;
    ReservationCache.getInstance().cancelReservation(can);
    if (++cancellationCount % 10 == 0) {
      logger.info("Received {} cancellations",cancellationCount);
    }
    logger.debug("Removing cancelled {} from reservation cache",can.getConsistentHashKey());
  }
 else   if (msg instanceof UniqueValueActor.Response) {
    UniqueValueActor.Response response=(UniqueValueActor.Response)msg;
    ReservationCache.getInstance().cancelReservation(response);
    logger.info("Removing completed {} from reservation cache",response.getConsistentHashKey());
  }
 else   if (msg instanceof DistributedPubSubMediator.SubscribeAck) {
    logger.debug("subscribing");
  }
 else {
    unhandled(msg);
  }
}

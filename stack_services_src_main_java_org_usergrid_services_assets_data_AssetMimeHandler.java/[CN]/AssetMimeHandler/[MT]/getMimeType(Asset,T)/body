{
  String contentType=MediaType.APPLICATION_OCTET_STREAM;
  if (asset.getProperty(AssetUtils.CONTENT_TYPE) != null) {
    contentType=asset.getProperty(AssetUtils.CONTENT_TYPE).toString();
  }
 else {
    Collection col;
    if (type instanceof byte[]) {
      col=mimeUtil.getMimeTypes((byte[])type);
    }
 else     if (type instanceof File) {
      col=mimeUtil.getMimeTypes((File)type);
    }
 else {
      return contentType;
    }
    if (!col.isEmpty()) {
      try {
        MimeType mime=((MimeType)col.iterator().next());
        contentType=mime.toString();
        asset.setProperty(AssetUtils.CONTENT_TYPE,contentType);
      }
 catch (      MimeException me) {
        logger.error("could not sniff mime type for asset {}",asset.getUuid());
      }
    }
  }
  return contentType;
}

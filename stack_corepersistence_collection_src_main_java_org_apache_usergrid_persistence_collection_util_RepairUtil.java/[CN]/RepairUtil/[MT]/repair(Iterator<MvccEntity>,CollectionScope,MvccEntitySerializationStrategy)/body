{
  if (!results.hasNext()) {
    return null;
  }
  final MvccEntity partialEntity=results.next();
  List<MvccEntity> partialEntities=new ArrayList<>();
  if (!partialEntity.getEntity().isPresent() && (partialEntity.getStatus() == MvccEntity.Status.DELETED || partialEntity.getStatus() == MvccEntity.Status.COMPLETE)) {
    return null;
  }
  if (partialEntity.getStatus() == MvccEntity.Status.COMPLETE) {
    return partialEntity;
  }
  partialEntities.add(partialEntity);
  while (results.hasNext()) {
    final MvccEntity previousEntity=results.next();
    partialEntities.add(previousEntity);
    if (previousEntity.getStatus() != MvccEntity.Status.PARTIAL) {
      return repairAndWrite(partialEntities,partialEntity,entitySerializationStrategy,collectionScope);
    }
  }
  return null;
}

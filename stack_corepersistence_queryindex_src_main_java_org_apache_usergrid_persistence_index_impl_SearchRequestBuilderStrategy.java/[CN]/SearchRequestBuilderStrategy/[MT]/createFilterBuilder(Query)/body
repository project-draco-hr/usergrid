{
  FilterBuilder filterBuilder=null;
  if (query.getRootOperand() != null) {
    QueryVisitor v=new EsQueryVistor();
    try {
      query.getRootOperand().visit(v);
    }
 catch (    IndexException ex) {
      throw new RuntimeException("Error building ElasticSearch query",ex);
    }
    filterBuilder=v.getFilterBuilder();
  }
  return filterBuilder;
}

{
  final Edge edge=delete.getData();
  final OrganizationScope scope=delete.getOrganizationScope();
  final UUID maxVersion=edge.getVersion();
  return edgeDeleteRepair.repair(scope,edge).flatMap(new Func1<MarkedEdge,Observable<Integer>>(){
    @Override public Observable<Integer> call(    final MarkedEdge markedEdge){
      Observable<Integer> sourceDelete=edgeMetaRepair.repairSources(scope,edge.getSourceNode(),edge.getType(),maxVersion);
      Observable<Integer> targetDelete=edgeMetaRepair.repairTargets(scope,edge.getTargetNode(),edge.getType(),maxVersion);
      return Observable.zip(sourceDelete,targetDelete,new Func2<Integer,Integer,Integer>(){
        @Override public Integer call(        final Integer sourceCount,        final Integer targetCount){
          return sourceCount + targetCount;
        }
      }
);
    }
  }
).map(new Func1<Integer,EdgeEvent<Edge>>(){
    @Override public EdgeEvent<Edge> call(    final Integer integer){
      return delete;
    }
  }
);
}

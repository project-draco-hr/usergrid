{
  Entity entity=new Entity("test");
  entity.setField(array);
  final UUID version=UUIDGenerator.newTimeUUID();
  EntityUtils.setVersion(entity,version);
  final ApplicationScope scope=new ApplicationScopeImpl(createId("application"));
  final IndexEdge indexEdge=new IndexEdgeImpl(createId("source"),"testEdgeType",SearchEdge.NodeType.SOURCE,1000);
  final Map<String,Object> entityMap=EntityToMapConverter.convert(scope,indexEdge,entity);
  final List<EntityField> fields=(List<EntityField>)entityMap.get(IndexingUtils.ENTITY_FIELDS);
  assertEquals(array.size(),fields.size());
  for (int i=0; i < array.size(); i++) {
    final EntityField field=fields.get(i);
    assertEquals(array.getName(),field.get(IndexingUtils.FIELD_NAME));
    assertEquals(array.getValue().get(i),field.get(indexType));
  }
}

{
  CountdownLatchJob counterJob=cassandraResource.getBean(CountdownLatchJob.class);
  counterJob.setLatch(getCount());
  for (int i=0; i < getCount(); i++) {
    scheduler.createJob("countdownLatch",System.currentTimeMillis(),new JobData());
  }
  boolean waited=getJobListener().blockTilDone(getCount(),15000L);
  assertTrue("Jobs ran",waited);
  assertTrue(getCount() + " successful jobs ran",getCount() == getJobListener().getSuccessCount());
  Thread.sleep(5000);
  counterJob.setLatch(getCount());
  for (int i=0; i < getCount(); i++) {
    scheduler.createJob("countdownLatch",System.currentTimeMillis(),new JobData());
  }
  waited=getJobListener().blockTilDone(2 * getCount(),15000L);
  assertTrue("Jobs ran",waited);
  assertTrue(2 * getCount() + " successful jobs ran",(2 * getCount()) == getJobListener().getSuccessCount());
}

{
  Map<String,String> payload=new HashMap<String,String>();
  UUID uuid=UUID.randomUUID();
  payload.put("name","foo");
  String path="devices/" + uuid;
  JsonNode response=appPath(path).put(JsonNode.class,payload);
  JsonNode entity=getEntity(response,0);
  assertNotNull(entity);
  String newUuid=entity.get("uuid").getTextValue();
  assertEquals(uuid.toString(),newUuid);
  response=appPath(path).delete(JsonNode.class);
  assertNotNull(getEntity(response,0));
  try {
    response=appPath(path).get(JsonNode.class);
    fail("should get 404 error");
  }
 catch (  UniformInterfaceException e) {
    assertEquals(404,e.getResponse().getStatus());
  }
  response=appPath(path).put(JsonNode.class,payload);
  entity=getEntity(response,0);
  assertNotNull(entity);
  response=appPath(path).get(JsonNode.class);
  assertNotNull(getEntity(response,0));
}

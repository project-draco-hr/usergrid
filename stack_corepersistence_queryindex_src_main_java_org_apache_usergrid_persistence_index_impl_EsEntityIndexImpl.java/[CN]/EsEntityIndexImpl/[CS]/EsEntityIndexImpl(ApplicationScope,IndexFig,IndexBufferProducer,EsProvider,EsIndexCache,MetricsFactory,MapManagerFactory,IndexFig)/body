{
  this.indexBatchBufferProducer=indexBatchBufferProducer;
  this.indexFig=indexFig;
  ValidationUtils.validateApplicationScope(appScope);
  this.applicationScope=appScope;
  this.esProvider=provider;
  this.config=config;
  this.cursorTimeout=config.getQueryCursorTimeout();
  this.indexIdentifier=IndexingUtils.createIndexIdentifier(config,appScope);
  this.alias=indexIdentifier.getAlias();
  this.failureMonitor=new FailureMonitorImpl(config,provider);
  this.aliasCache=indexCache;
  this.metricsFactory=metricsFactory;
  this.addTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.add.index.timer");
  this.removeAliasTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.remove.index.alias.timer");
  this.addReadAliasTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.add.read.alias.timer");
  this.addWriteAliasTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.add.write.alias.timer");
  this.mappingTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.create.mapping.timer");
  this.refreshTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.refresh.timer");
  this.searchTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.search.timer");
  this.cursorTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.search.cursor.timer");
  this.getVersionsTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.get.versions.timer");
  this.allVersionsTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.delete.all.versions.timer");
  this.deletePreviousTimer=metricsFactory.getTimer(EsEntityIndexImpl.class,"es.entity.index.delete.previous.versions.timer");
  final MapScope mapScope=new MapScopeImpl(appScope.getApplication(),"cursorcache");
  mapManager=mapManagerFactory.createMapManager(mapScope);
}

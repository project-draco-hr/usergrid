{
  final Timer.Context timeRemoveAlias=updateAliasTimer.time();
  try {
    String indexName=indexIdentifier.getIndex(indexSuffix);
    final AdminClient adminClient=esProvider.getClient().admin();
    String[] indexNames=getIndexesFromEs(AliasType.Write);
    final IndicesAliasesRequestBuilder aliasesRequestBuilder=adminClient.indices().prepareAliases();
    for (    String currentIndex : indexNames) {
      aliasesRequestBuilder.removeAlias(currentIndex,alias.getWriteAlias());
      logger.info("Removing existing write Alias Name [{}] from Index [{}]",alias.getReadAlias(),currentIndex);
    }
    aliasesRequestBuilder.addAlias(indexName,alias.getReadAlias());
    logger.info("Created new read Alias Name [{}] on Index [{}]",alias.getReadAlias(),indexName);
    aliasesRequestBuilder.addAlias(indexName,alias.getWriteAlias());
    logger.info("Created new write Alias Name [{}] on Index [{}]",alias.getWriteAlias(),indexName);
    final IndicesAliasesResponse result=aliasesRequestBuilder.execute().actionGet();
    final boolean isAcknowledged=result.isAcknowledged();
    if (!isAcknowledged) {
      throw new RuntimeException("Unable to add aliases to the new index " + indexSuffix);
    }
  }
  finally {
    aliasCache.invalidate(alias);
    timeRemoveAlias.stop();
  }
}

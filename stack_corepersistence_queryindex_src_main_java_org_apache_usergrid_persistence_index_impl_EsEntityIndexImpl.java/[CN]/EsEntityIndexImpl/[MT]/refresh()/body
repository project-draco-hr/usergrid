{
  final RetryOperation retryOperation=new RetryOperation(){
    @Override public boolean doOp(){
      try {
        String[] indexes=ArrayUtils.addAll(getIndexes(AliasType.Write),getIndexes(AliasType.Write));
        if (indexes.length == 0) {
          logger.debug("Not refreshing indexes, none found for app {}",applicationScope.getApplication().getUuid());
          return true;
        }
        esProvider.getClient().admin().indices().prepareRefresh(indexes).execute().actionGet();
        logger.debug("Refreshed indexes: {}",StringUtils.join(indexes,", "));
        return true;
      }
 catch (      IndexMissingException e) {
        logger.error("Unable to refresh index. Waiting before sleeping.",e);
        throw e;
      }
    }
  }
;
  doInRetry(retryOperation);
}

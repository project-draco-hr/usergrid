{
  final int numberOfShards=config.getNumberOfShards();
  final int numberOfReplicas=config.getNumberOfReplicas();
  final AdminClient admin=esProvider.getClient().admin();
  Settings settings=ImmutableSettings.settingsBuilder().put("index.number_of_shards",numberOfShards).put("index.number_of_replicas",numberOfReplicas).build();
  String indexVersionName=indexIdentifier.getIndex(0);
  try {
    final CreateIndexResponse cir=admin.indices().prepareCreate(indexVersionName).setSettings(settings).execute().actionGet();
    logger.info("Created new Index Name [{}] ACK=[{}]",indexVersionName,cir.isAcknowledged());
  }
 catch (  IndexAlreadyExistsException e) {
    logger.info("Index Name [{}] already exists",indexVersionName);
  }
  try {
    Boolean isAck=admin.indices().prepareAliases().addAlias(indexVersionName,alias.getReadAlias()).execute().actionGet().isAcknowledged();
    logger.info("Created new read Alias Name [{}] ACK=[{}]",alias,isAck);
    isAck=admin.indices().prepareAliases().addAlias(indexVersionName,alias.getWriteAlias()).execute().actionGet().isAcknowledged();
    logger.info("Created new write Alias Name [{}] ACK=[{}]",alias,isAck);
  }
 catch (  Exception e) {
    logger.warn("Failed to create alias ",e);
  }
}

{
  try {
    if (!mappingsCreated.getAndSet(true)) {
      createMappings();
    }
    AdminClient admin=client.admin();
    CreateIndexResponse cir=admin.indices().prepareCreate(indexName).setSettings(new HashMap<String,Object>(){
{
        put("index.number_of_shards",config.getNumberOfShards());
        put("index.number_of_replicas",config.numberOfReplicas());
      }
    }
).execute().actionGet();
    logger.info("Created new Index Name [{}] ACK=[{}]",indexName,cir.isAcknowledged());
    testNewIndex();
  }
 catch (  IndexAlreadyExistsException expected) {
  }
catch (  IOException e) {
    throw new RuntimeException("Unable to initialize index",e);
  }
}

{
  IndexValidationUtils.validateSearchEdge(edge);
  Preconditions.checkNotNull(entityId,"entityId cannot be null");
  SearchResponse searchResponse;
  List<CandidateResult> candidates=new ArrayList<>();
  final int searchLimit=Math.max(2,indexFig.getVersionQueryLimit());
  final QueryBuilder entityQuery=QueryBuilders.termQuery(IndexingUtils.EDGE_NODE_ID_FIELDNAME,IndexingUtils.nodeId(edge.getNodeId()));
  final SearchRequestBuilder srb=searchRequestBuilderStrategyV2.getBuilder();
  if (logger.isDebugEnabled()) {
    logger.debug("Searching for edges in (read alias): {}\n  nodeId: {},\n   query: {} ",this.alias.getReadAlias(),entityId,srb);
  }
  try {
    long queryTimestamp=0L;
    while (true) {
      QueryBuilder timestampQuery=QueryBuilders.rangeQuery(IndexingUtils.EDGE_TIMESTAMP_FIELDNAME).gte(queryTimestamp);
      QueryBuilder finalQuery=QueryBuilders.boolQuery().must(entityQuery).must(timestampQuery);
      searchResponse=srb.setQuery(finalQuery).setSize(searchLimit).addSort(IndexingUtils.EDGE_TIMESTAMP_FIELDNAME,SortOrder.ASC).execute().actionGet();
      int responseSize=searchResponse.getHits().getHits().length;
      if (responseSize == 0) {
        break;
      }
      queryTimestamp=(long)searchResponse.getHits().getAt(responseSize - 1).getSource().get(IndexingUtils.EDGE_TIMESTAMP_FIELDNAME);
      candidates=aggregateScrollResults(candidates,searchResponse,null);
      if (responseSize < searchLimit) {
        break;
      }
    }
  }
 catch (  Throwable t) {
    logger.error("Unable to communicate with Elasticsearch",t);
    failureMonitor.fail("Unable to execute batch",t);
    throw t;
  }
  failureMonitor.success();
  return new CandidateResults(candidates,Collections.EMPTY_SET);
}

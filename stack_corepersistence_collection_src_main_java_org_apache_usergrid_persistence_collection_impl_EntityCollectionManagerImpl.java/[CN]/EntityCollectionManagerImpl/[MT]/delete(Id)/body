{
  Preconditions.checkNotNull(entityId,"Entity id is required in this stage");
  Preconditions.checkNotNull(entityId.getUuid(),"Entity id is required in this stage");
  Preconditions.checkNotNull(entityId.getType(),"Entity type is required in this stage");
  Observable<Void> o=Observable.from(new CollectionIoEvent<Id>(collectionScope,entityId)).map(markStart).doOnNext(markCommit).map(new Func1<CollectionIoEvent<MvccEntity>,Void>(){
    @Override public Void call(    final CollectionIoEvent<MvccEntity> mvccEntityCollectionIoEvent){
      MvccEntity entity=mvccEntityCollectionIoEvent.getEvent();
      Task<Void> task=entityDeletedFactory.getTask(entity.getId(),entity.getVersion());
      taskExecutor.submit(task);
      return null;
    }
  }
);
  return o;
}

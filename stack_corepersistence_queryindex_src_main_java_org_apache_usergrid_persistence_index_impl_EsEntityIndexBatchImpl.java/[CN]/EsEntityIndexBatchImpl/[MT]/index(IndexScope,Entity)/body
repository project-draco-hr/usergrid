{
  IndexValidationUtils.validateIndexScope(indexScope);
  ValidationUtils.verifyEntityWrite(entity);
  ValidationUtils.verifyVersion(entity.getVersion());
  entity.setField(new StringField(APPLICATION_ID_FIELDNAME,IndexingUtils.idString(applicationScope.getApplication())));
  final String context=createContextName(applicationScope,indexScope);
  if (log.isDebugEnabled()) {
    log.debug("Indexing entity {}:{}\n   alias: {}\n" + "   app: {}\n   scope owner: {}\n   scope name: {}\n   context: {}",entity.getId().getType(),entity.getId().getUuid(),alias.getWriteAlias(),applicationScope.getApplication(),indexScope.getOwner(),indexScope.getName(),context);
  }
  ValidationUtils.verifyEntityWrite(entity);
  Map<String,Object> entityAsMap=entityToMap(entity,context);
  String indexId=createIndexDocId(entity,context);
  log.debug("Indexing entity documentId {} data {} ",indexId,entityAsMap);
  final SearchType entityType=SearchType.fromId(entity.getId());
  container.addIndexRequest(new IndexRequest(alias.getWriteAlias(),entityType.getTypeName(applicationScope),indexId,entityAsMap));
  return this;
}

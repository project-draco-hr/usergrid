{
  IndexValidationUtils.validateIndexScope(indexScope);
  final String context=createContextName(indexScope);
  final String entityType=entity.getId().getType();
  if (log.isDebugEnabled()) {
    log.debug("Indexing entity {}:{} in scope\n   app {}\n   " + "owner {}\n   name {}\n   type {} \n scope type {}",new Object[]{entity.getId().getType(),entity.getId().getUuid(),applicationScope.getApplication(),indexScope.getOwner(),indexScope.getName(),entityType,context});
  }
  ValidationUtils.verifyEntityWrite(entity);
  Map<String,Object> entityAsMap=entityToMap(entity,context);
  String indexId=createIndexDocId(entity,context);
  log.debug("Indexing entity documentId {} data {} ",indexId,entityAsMap);
  bulkRequest.add(client.prepareIndex(alias.getWriteAlias(),entityType,indexId).setSource(entityAsMap));
  maybeFlush();
  return this;
}

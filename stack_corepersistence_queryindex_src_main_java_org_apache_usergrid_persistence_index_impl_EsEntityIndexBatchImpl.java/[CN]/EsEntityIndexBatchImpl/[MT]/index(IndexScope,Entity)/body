{
  IndexValidationUtils.validateIndexScope(indexScope);
  ValidationUtils.verifyEntityWrite(entity);
  final String context=createContextName(indexScope);
  final String entityType=entity.getId().getType();
  if (log.isDebugEnabled()) {
    log.debug("Indexing entity {}:{}\n   alias: {}\n" + "   app: {}\n   scope owner: {}\n   scope name: {}\n   context: {}",entity.getId().getType(),entity.getId().getUuid(),alias.getWriteAlias(),applicationScope.getApplication(),indexScope.getOwner(),indexScope.getName(),context);
  }
  ValidationUtils.verifyEntityWrite(entity);
  Map<String,Object> entityAsMap=entityToMap(entity,context);
  String indexId=createIndexDocId(entity,context);
  log.debug("Indexing entity documentId {} data {} ",indexId,entityAsMap);
  bulkRequest.add(client.prepareIndex(alias.getWriteAlias(),entityType,indexId).setSource(entityAsMap));
  maybeFlush();
  return this;
}

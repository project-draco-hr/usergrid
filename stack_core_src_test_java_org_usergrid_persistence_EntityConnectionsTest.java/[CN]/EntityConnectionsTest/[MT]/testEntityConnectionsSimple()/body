{
  UUID applicationId=createApplication("testOrganization" + UUIDUtils.newTimeUUID(),"testEntityConnections");
  assertNotNull(applicationId);
  EntityManager em=emf.getEntityManager(applicationId);
  assertNotNull(em);
  User first=new User();
  first.setUsername("first");
  first.setEmail("first@usergrid.com");
  Entity firstUserEntity=em.create(first);
  assertNotNull(firstUserEntity);
  User second=new User();
  second.setUsername("second");
  second.setEmail("second@usergrid.com");
  Entity secondUserEntity=em.create(second);
  assertNotNull(secondUserEntity);
  em.createConnection(firstUserEntity,"likes",secondUserEntity);
  Results r=em.getConnectedEntities(first.getUuid(),"likes",null,Level.IDS);
  List<ConnectionRef> connections=r.getConnections();
  assertNotNull(connections);
  assertEquals(1,connections.size());
  assertEquals(secondUserEntity.getUuid(),connections.get(0).getConnectedEntity().getUuid());
  assertEquals(firstUserEntity.getUuid(),connections.get(0).getConnectingEntity().getUuid());
}

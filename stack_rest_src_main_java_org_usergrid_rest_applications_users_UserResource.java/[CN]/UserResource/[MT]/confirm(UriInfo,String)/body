{
  try {
    ActivationState state=management.handleConfirmationTokenForAppUser(getApplicationId(),getUserUuid(),token);
    if (state == ActivationState.CONFIRMED_AWAITING_ACTIVATION) {
      return new Viewable("confirm",this);
    }
    return new Viewable("activate",this);
  }
 catch (  TokenException e) {
    return new Viewable("bad_confirmation_token",this);
  }
catch (  Exception e) {
    return new Viewable("error",e);
  }
}

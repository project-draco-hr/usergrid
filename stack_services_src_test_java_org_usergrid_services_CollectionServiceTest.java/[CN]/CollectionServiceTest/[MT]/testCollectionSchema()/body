{
  UUID applicationId=createApplication("testOrganization","testCollectionSchema");
  ServiceManager sm=smf.getServiceManager(applicationId);
  Map<String,Object> properties=JsonUtils.toJsonMap(readSchema("cat-schema.json"));
  testDataRequest(sm,ServiceAction.PUT,properties,"cats","schema");
  try {
    properties=JsonUtils.toJsonMap(readSchema("bad-schema.json"));
    testDataRequest(sm,ServiceAction.PUT,properties,"dogs","schema");
    Assert.fail();
  }
 catch (  InvalidEntitySchemaSyntaxException iae) {
  }
  try {
    properties=new LinkedHashMap<String,Object>();
    properties.put("name","Tom");
    Entity cat=testRequest(sm,ServiceAction.POST,1,properties,"cats").getEntity();
    Assert.fail();
  }
 catch (  EntityValidationException iae) {
  }
  properties=new LinkedHashMap<String,Object>();
  properties.put("name","Tom");
  properties.put("color","tabby");
  Entity cat=testRequest(sm,ServiceAction.POST,1,properties,"cats").getEntity();
  assertNotNull(cat);
}

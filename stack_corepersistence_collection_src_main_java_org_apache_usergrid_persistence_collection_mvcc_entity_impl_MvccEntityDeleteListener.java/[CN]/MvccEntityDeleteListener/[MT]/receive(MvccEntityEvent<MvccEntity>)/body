{
  final MvccEntity entity=entityEvent.getData();
  return Observable.create(new ObservableIterator<MvccEntity>("getEdgesToTarget"){
    @Override protected Iterator<MvccEntity> getIterator(){
      Iterator<MvccEntity> iterator=entityMetadataSerialization.loadHistory(entityEvent.getCollectionScope(),entity.getId(),entity.getVersion(),100);
      return iterator;
    }
  }
).subscribeOn(Schedulers.io()).map(new Func1<MvccEntity,MvccEntity>(){
    @Override public MvccEntity call(    MvccEntity mvccEntity){
      try {
        entityMetadataSerialization.delete(entityEvent.getCollectionScope(),mvccEntity.getId(),mvccEntity.getVersion()).execute();
      }
 catch (      ConnectionException e) {
        throw new RuntimeException("Unable to execute mutation",e);
      }
      return mvccEntity;
    }
  }
);
}

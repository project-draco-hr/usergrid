{
  final MvccEntity entity=entityEvent.getData();
  return Observable.from(entity).map(new Func1<MvccEntity,MvccEntityEvent<MvccEntity>>(){
    @Override public MvccEntityEvent<MvccEntity> call(    MvccEntity mvccEntity){
      MutationBatch batch=entityMetadataSerialization.delete(entityEvent.getCollectionScope(),entity.getId(),entity.getVersion());
      try {
        batch.execute();
      }
 catch (      ConnectionException e) {
        throw new RuntimeException("Unable to delete marked graph node " + entity,e);
      }
      return entityEvent;
    }
  }
);
}

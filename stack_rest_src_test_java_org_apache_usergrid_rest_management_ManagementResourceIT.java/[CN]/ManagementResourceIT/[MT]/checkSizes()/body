{
  final String appname=clientSetup.getAppName();
  this.app().collection("testCollection").post(new Entity().chainPut("name","test"));
  refreshIndex();
  Entity size=management().orgs().org(clientSetup.getOrganizationName()).app().addToPath(appname).addToPath("size").get();
  Entity rolesSize=management().orgs().org(clientSetup.getOrganizationName()).app().addToPath(appname).addToPath("size/roles").get();
  assertTrue(size != null);
  assertTrue(rolesSize != null);
  int sum=(int)((LinkedHashMap)((LinkedHashMap)size.metadata().get("aggregation")).get("application")).get("sum");
  int sumRoles=(int)((LinkedHashMap)((LinkedHashMap)rolesSize.metadata().get("aggregation")).get("roles")).get("sum");
  assertTrue(size != null);
  assertTrue(rolesSize != null);
  assertNotEquals(sum,sumRoles);
  assertTrue(sum > sumRoles);
}

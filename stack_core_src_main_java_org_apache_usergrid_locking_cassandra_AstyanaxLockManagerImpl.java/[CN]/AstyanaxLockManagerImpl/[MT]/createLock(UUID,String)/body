{
  String lockPath=LockPathBuilder.buildPath(applicationId,path);
  ConsistencyLevel consistencyLevel;
  try {
    consistencyLevel=ConsistencyLevel.valueOf(cassandraFig.getLocksCl());
  }
 catch (  IllegalArgumentException e) {
    consistencyLevel=ConsistencyLevel.CL_LOCAL_QUORUM;
  }
  ColumnPrefixDistributedRowLock<String> lock=new ColumnPrefixDistributedRowLock<>(keyspace,columnFamily,lockPath).expireLockAfter(Integer.MAX_VALUE,TimeUnit.MILLISECONDS).withConsistencyLevel(consistencyLevel);
  return new AstyanaxLockImpl(lock);
}

{
  this.cassandraFig=cassandraFig;
  int maxRetries=cassandraFig.getLockManagerInitRetries();
  int retries=0;
  boolean famReady=false;
  while (!famReady && retries++ < maxRetries) {
    try {
      keyspace=cassandraCluster.getLocksKeyspace();
      createLocksKeyspace();
      columnFamily=createLocksColumnFamily();
      famReady=true;
    }
 catch (    Throwable t) {
      String msg="Error " + t.getClass().getSimpleName() + " creating locks keyspace try "+ retries;
      if (logger.isDebugEnabled()) {
        logger.error(msg,t);
      }
 else {
        logger.error(msg);
      }
      try {
        Thread.sleep(cassandraFig.getLockManagerInitInterval());
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
}

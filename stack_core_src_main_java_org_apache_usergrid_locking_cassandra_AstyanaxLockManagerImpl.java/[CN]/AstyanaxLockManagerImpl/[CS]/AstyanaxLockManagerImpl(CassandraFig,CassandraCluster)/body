{
  this.cassandraFig=cassandraFig;
  int maxRetries=cassandraFig.getLockManagerInitRetries();
  int retries=0;
  boolean famReady=false;
  Set<Class> seenBefore=new HashSet<>(10);
  while (!famReady && retries++ < maxRetries) {
    try {
      keyspace=cassandraCluster.getLocksKeyspace();
      createLocksKeyspace();
      columnFamily=createLocksColumnFamily();
      famReady=true;
    }
 catch (    Throwable t) {
      final String msg;
      if (t instanceof PoolTimeoutException || t instanceof NoAvailableHostsException) {
        msg=retries + ": Cannot connect to Cassandra (" + t.getClass().getSimpleName()+ ")";
      }
 else {
        msg=retries + ": Error (" + t.getClass().getSimpleName()+ ") tries="+ retries;
      }
      if (!seenBefore.contains(t.getClass())) {
        logger.error(msg,t);
      }
 else {
        logger.error(msg);
      }
      seenBefore.add(t.getClass());
      try {
        Thread.sleep(cassandraFig.getLockManagerInitInterval());
      }
 catch (      InterruptedException ignored) {
      }
    }
  }
}

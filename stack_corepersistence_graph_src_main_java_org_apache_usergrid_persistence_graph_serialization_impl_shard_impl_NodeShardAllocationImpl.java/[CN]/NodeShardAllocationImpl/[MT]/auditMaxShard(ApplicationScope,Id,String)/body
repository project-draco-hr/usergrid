{
  final Iterator<Long> maxShards=getShards(scope,nodeId,Optional.<Long>absent(),edgeType);
  if (!maxShards.hasNext()) {
    return false;
  }
  final long maxShard=maxShards.next();
  final long count=edgeShardCounterSerialization.getCount(new ShardKey(scope,nodeId,maxShard,edgeType));
  if (count < graphFig.getShardSize()) {
    return false;
  }
  final long newShardTime=timeService.getCurrentTime() + graphFig.getShardCacheTimeout() * 2;
  try {
    this.edgeShardSerialization.writeEdgeMeta(scope,nodeId,newShardTime,edgeType).execute();
  }
 catch (  ConnectionException e) {
    throw new GraphRuntimeException("Unable to write the new edge metadata");
  }
  return true;
}

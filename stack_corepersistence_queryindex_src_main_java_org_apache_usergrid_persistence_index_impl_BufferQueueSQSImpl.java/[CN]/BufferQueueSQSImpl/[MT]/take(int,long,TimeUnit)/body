{
  final int actualTake=Math.min(10,takeSize);
  List<QueueMessage> messages=queue.getMessages(actualTake,indexFig.getIndexQueueTimeout(),(int)timeUnit.toMillis(timeout),IndexOperationMessage.class);
  final List<IndexOperationMessage> response=new ArrayList<>(messages.size());
  for (  final QueueMessage message : messages) {
    final IndexOperationMessage messageBody=(IndexOperationMessage)message.getBody();
    SqsIndexOperationMessage operation=new SqsIndexOperationMessage(message,messageBody);
    response.add(operation);
  }
  return response;
}

{
  this.entityIndex=entityIndex;
  this.indexBatchBufferProducer=indexBatchBufferProducer;
  this.indexCache=indexCache;
  this.indexFig=indexFig;
  this.indexIdentifier=indexIdentifier;
  ValidationUtils.validateApplicationScope(appScope);
  this.applicationScope=appScope;
  final MapScope mapScope=new MapScopeImpl(appScope.getApplication(),"cursorcache");
  this.failureMonitor=new FailureMonitorImpl(config,provider);
  this.esProvider=provider;
  mapManager=mapManagerFactory.createMapManager(mapScope);
  this.searchTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"search.timer");
  this.cursorTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"search.cursor.timer");
  this.cursorTimeout=config.getQueryCursorTimeout();
  this.deleteApplicationTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"delete.application");
  this.deleteApplicationMeter=metricsFactory.getMeter(EsApplicationEntityIndexImpl.class,"delete.application.meter");
  this.alias=indexIdentifier.getAlias();
  this.searchRequest=new SearchRequestBuilderStrategy(esProvider,appScope,alias,cursorTimeout);
}

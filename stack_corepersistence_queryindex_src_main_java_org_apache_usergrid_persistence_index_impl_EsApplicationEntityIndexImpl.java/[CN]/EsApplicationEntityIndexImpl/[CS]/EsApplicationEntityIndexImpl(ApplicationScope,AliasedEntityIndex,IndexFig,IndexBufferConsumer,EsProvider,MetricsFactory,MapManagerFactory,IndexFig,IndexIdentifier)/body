{
  this.entityIndex=entityIndex;
  this.indexBatchBufferProducer=indexBatchBufferProducer;
  this.indexFig=indexFig;
  this.indexIdentifier=indexIdentifier;
  ValidationUtils.validateApplicationScope(appScope);
  this.applicationScope=appScope;
  final MapScope mapScope=new MapScopeImpl(appScope.getApplication(),"cursorcache");
  this.failureMonitor=new FailureMonitorImpl(config,provider);
  this.esProvider=provider;
  mapManager=mapManagerFactory.createMapManager(mapScope);
  this.searchTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"base.search");
  this.cursorTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"cursor.search");
  this.cursorTimeout=config.getQueryCursorTimeout();
  this.queryTimeout=config.getWriteTimeout();
  this.deleteApplicationTimer=metricsFactory.getTimer(EsApplicationEntityIndexImpl.class,"application.delete");
  this.deleteApplicationMeter=metricsFactory.getMeter(EsApplicationEntityIndexImpl.class,"application.delete");
  this.alias=indexIdentifier.getAlias();
  this.searchRequest=new SearchRequestBuilderStrategy(esProvider,appScope,alias,cursorTimeout);
  this.searchRequestBuilderStrategyV2=new SearchRequestBuilderStrategyV2(esProvider,appScope,alias,cursorTimeout);
}

{
  final AtomicLong queueSize=new AtomicLong();
  this.consumer=Observable.create(producer).subscribeOn(Schedulers.io()).doOnNext(new Action1<RequestBuilderContainer>(){
    @Override public void call(    RequestBuilderContainer requestBuilderContainer){
      queueSize.addAndGet(requestBuilderContainer.getBuilder().size());
    }
  }
).buffer(config.getIndexBufferTimeout(),TimeUnit.MILLISECONDS,config.getIndexBufferSize()).doOnNext(new Action1<List<RequestBuilderContainer>>(){
    @Override public void call(    List<RequestBuilderContainer> containerList){
      flushTimer.time();
      indexSizeCounter.dec(containerList.size());
      if (containerList.size() > 0) {
        execute(containerList);
      }
    }
  }
);
  consumer.subscribe();
}

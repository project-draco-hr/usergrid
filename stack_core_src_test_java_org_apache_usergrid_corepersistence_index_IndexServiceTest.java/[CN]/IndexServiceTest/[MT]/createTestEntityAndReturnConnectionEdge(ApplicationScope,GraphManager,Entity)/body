{
  final EntityCollectionManager collectionManager=entityCollectionManagerFactory.createCollectionManager(applicationScope);
  final ApplicationEntityIndex applicationEntityIndex=entityIndexFactory.createApplicationEntityIndex(applicationScope);
  final Edge collectionEdge=createEntityandCollectionEdge(applicationScope,graphManager,testEntity);
  final Id connectingId=createId("connecting");
  final Edge connectionEdge=CpNamingUtils.createConnectionEdge(connectingId,"likes",testEntity.getId());
  final Edge connectionSearch=graphManager.writeEdge(connectionEdge).toBlocking().last();
  indexService.indexEntity(applicationScope,testEntity).count().toBlocking().last();
  final SearchEdge collectionSearchEdge=CpNamingUtils.createSearchEdgeFromSource(collectionEdge);
  getResults(applicationEntityIndex,collectionSearchEdge,SearchTypes.fromTypes(testEntity.getId().getType()),1);
  final SearchEdge connectionSearchEdge=CpNamingUtils.createSearchEdgeFromSource(connectionSearch);
  getResults(applicationEntityIndex,connectionSearchEdge,SearchTypes.fromTypes(testEntity.getId().getType()),1);
  return connectionSearch;
}
